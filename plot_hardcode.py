import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d

esno_ldpc_20_10_classic = [-7, -6.50000000000000, -6, -5.50000000000000, -5, -4.50000000000000, -4, -3.50000000000000, -3, -2.50000000000000, -2, -1.50000000000000, -1, -0.500000000000000, 0, 0.500000000000000, 1, 1.50000000000000, 2, 2.50000000000000, 3, 3.50000000000000, 4, 4.50000000000000, 5, 5.50000000000000]
fer_ldpc_20_10_classic = [1, 0.909090909090909, 0.909090909090909, 1, 0.833333333333333, 0.666666666666667, 0.625000000000000, 0.625000000000000, 0.666666666666667, 0.588235294117647, 0.312500000000000, 0.333333333333333, 0.400000000000000, 0.163934426229508, 0.222222222222222, 0.172413793103448, 0.0833333333333333, 0.0492610837438424, 0.0342465753424658, 0.0200000000000000, 0.00733137829912024, 0.00788643533123028, 0.00282645562464669, 0.00149186931224825, 0.000486570650058389, 0.000344174840819136]
ber_ldpc_20_10_classic = [0.210000000000000, 0.231818181818182, 0.240909090909091, 0.265000000000000, 0.191666666666667, 0.106666666666667, 0.146875000000000, 0.131250000000000, 0.116666666666667, 0.102941176470588, 0.0640625000000000, 0.0566666666666667, 0.0700000000000000, 0.0262295081967213, 0.0344444444444444, 0.0206896551724138, 0.00958333333333333, 0.00615763546798030, 0.00547945205479452, 0.00280000000000000, 0.000989736070381232, 0.000867507886435331, 0.000423968343697004, 0.000216321050275996, 7.78513040093422e-05, 4.47427293064877e-05]

esno_ldpc_20_10_bcjr = [-6, -5.5, -5.0, -4.5, -4.0, -3.5, -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5]
fer_ldpc_20_10_bcjr = [1.0, 1.0, 1.0, 1.0, 0.9090909090909091, 0.9090909090909091, 0.9090909090909091, 0.7142857142857143, 0.8333333333333334, 0.625, 0.625, 0.5263157894736842, 0.3225806451612903, 0.4166666666666667, 0.24390243902439024, 0.23809523809523808, 0.10309278350515463, 0.056179775280898875, 0.05025125628140704, 0.036101083032490974, 0.02824858757062147, 0.019569471624266144, 0.008319467554076539, 0.0033647375504710633]
ber_ldpc_20_10_bcjr = [0.05, 0.05, 0.05, 0.05, 0.045454545454545456, 0.045454545454545456, 0.045454545454545456, 0.03571428571428571, 0.041666666666666664, 0.03125, 0.03125, 0.02631578947368421, 0.016129032258064516, 0.020833333333333332, 0.012195121951219513, 0.011904761904761904, 0.005154639175257732, 0.0028089887640449437, 0.002512562814070352, 0.0018050541516245488, 0.0014124293785310734, 0.0009784735812133072, 0.00041597337770382697, 0.00016823687752355316]


esno_ldpc_16_10_classic = [-7, -6.90000000000000, -6.80000000000000, -6.70000000000000, -6.60000000000000, -6.50000000000000, -6.40000000000000, -6.30000000000000, -6.20000000000000, -6.10000000000000, -6, -5.90000000000000, -5.80000000000000, -5.70000000000000, -5.60000000000000, -5.50000000000000, -5.40000000000000, -5.30000000000000, -5.20000000000000, -5.10000000000000, -5, -4.90000000000000, -4.80000000000000, -4.70000000000000, -4.60000000000000, -4.50000000000000, -4.40000000000000, -4.30000000000000, -4.20000000000000, -4.10000000000000, -4, -3.90000000000000, -3.80000000000000, -3.70000000000000, -3.60000000000000, -3.50000000000000, -3.40000000000000, -3.30000000000000, -3.20000000000000, -3.10000000000000, -3, -2.90000000000000, -2.80000000000000, -2.70000000000000, -2.60000000000000, -2.50000000000000, -2.40000000000000, -2.30000000000000, -2.20000000000000, -2.10000000000000, -2, -1.90000000000000, -1.80000000000000, -1.70000000000000, -1.60000000000000, -1.50000000000000, -1.40000000000000, -1.30000000000000, -1.20000000000000, -1.10000000000000, -1, -0.900000000000000, -0.800000000000000, -0.699999999999999, -0.600000000000000, -0.500000000000000, -0.399999999999999, -0.300000000000000, -0.199999999999999, -0.100000000000001, 0, 0.0999999999999996, 0.200000000000000, 0.300000000000000, 0.399999999999999, 0.500000000000000, 0.600000000000000, 0.700000000000000, 0.800000000000000, 0.900000000000000, 1, 1.10000000000000, 1.20000000000000, 1.30000000000000, 1.40000000000000, 1.50000000000000, 1.60000000000000, 1.70000000000000, 1.80000000000000, 1.90000000000000, 2, 2.10000000000000, 2.20000000000000, 2.30000000000000, 2.40000000000000, 2.50000000000000, 2.60000000000000, 2.70000000000000, 2.80000000000000, 2.90000000000000, 3, 3.10000000000000, 3.20000000000000, 3.30000000000000, 3.40000000000000, 3.50000000000000, 3.60000000000000, 3.70000000000000, 3.80000000000000, 3.90000000000000, 4, 4.10000000000000, 4.20000000000000, 4.30000000000000, 4.40000000000000, 4.50000000000000, 4.60000000000000, 4.70000000000000, 4.80000000000000, 4.90000000000000, 5, 5.10000000000000, 5.20000000000000, 5.30000000000000, 5.40000000000000, 5.50000000000000, 5.60000000000000, 5.70000000000000, 5.80000000000000, 5.90000000000000, 6, 6.10000000000000, 6.20000000000000, 6.30000000000000, 6.40000000000000, 6.50000000000000, 6.60000000000000, 6.70000000000000]
fer_ldpc_16_10_classic = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0.993333333333333, 1, 0.979090909090909, 0.962380952380952, 0.952380952380952, 0.869565217391304, 1, 0.909090909090909, 0.952380952380952, 1, 0.869565217391304, 0.952380952380952, 0.909090909090909, 0.952380952380952, 1, 0.833333333333333, 0.909090909090909, 0.833333333333333, 0.909090909090909, 0.909090909090909, 1, 0.869565217391304, 0.952380952380952, 0.800000000000000, 0.833333333333333, 0.740740740740741, 0.769230769230769, 0.740740740740741, 0.952380952380952, 0.833333333333333, 0.800000000000000, 0.800000000000000, 0.740740740740741, 0.869565217391304, 0.769230769230769, 0.952380952380952, 0.740740740740741, 0.625000000000000, 0.555555555555556, 0.526315789473684, 0.588235294117647, 0.645161290322581, 0.454545454545455, 0.487804878048781, 0.526315789473684, 0.434782608695652, 0.465116279069767, 0.416666666666667, 0.714285714285714, 0.344827586206897, 0.357142857142857, 0.400000000000000, 0.285714285714286, 0.322580645161290, 0.370370370370370, 0.266666666666667, 0.235294117647059, 0.322580645161290, 0.263157894736842, 0.219780219780220, 0.263157894736842, 0.194174757281553, 0.198019801980198, 0.161290322580645, 0.243902439024390, 0.165289256198347, 0.121951219512195, 0.103626943005181, 0.105820105820106, 0.127388535031847, 0.109289617486339, 0.0956937799043062, 0.132450331125828, 0.0869565217391304, 0.0851063829787234, 0.0985221674876847, 0.0836820083682008, 0.0576368876080692, 0.0619195046439629, 0.0518134715025907, 0.0475059382422803, 0.0617283950617284, 0.0365630712979890, 0.0298062593144560, 0.0284090909090909, 0.0242718446601942, 0.0372439478584730, 0.0241254523522316, 0.0180018001800180, 0.0131406044678055, 0.0129785853341986, 0.0125313283208020, 0.0125786163522013, 0.0117164616285882, 0.0169779286926995, 0.00729660707770887, 0.0110436223081171, 0.00594530321046373, 0.00695652173913044, 0.00573230151905990, 0.00913659205116492, 0.00453206435531385, 0.00321905681635281, 0.00247005063603804, 0.00214132762312634, 0.00437254044599913, 0.00201085863663784, 0.00283889283179560, 0.00173958423936679, 0.00108926529056152, 0.00108559952233621, 0.000996412913511359, 0.000650026001040042, 0.000821557673348669, 0.000416553849998959, 0.000404440759539746, 0.000288475407471513, 0.000314035831488373, 0.000255007713983348, 0.000237619998099040, 0.000193894269454866, 0.000151257326526754, 0.000138225597998493, 0.000116274337672304, 8.27444685322786e-05]
ber_ldpc_16_10_classic = [0.246875000000000, 0.241071428571429, 0.256250000000000, 0.238095238095238, 0.240625000000000, 0.271875000000000, 0.262500000000000, 0.247159090909091, 0.237500000000000, 0.253125000000000, 0.241071428571429, 0.256250000000000, 0.278125000000000, 0.205729166666667, 0.268750000000000, 0.198863636363636, 0.287500000000000, 0.199404761904762, 0.179347826086957, 0.209375000000000, 0.173295454545455, 0.193452380952381, 0.200000000000000, 0.206521739130435, 0.193452380952381, 0.178977272727273, 0.187500000000000, 0.193750000000000, 0.195312500000000, 0.167613636363636, 0.138020833333333, 0.167613636363636, 0.227272727272727, 0.206250000000000, 0.138586956521739, 0.160714285714286, 0.137500000000000, 0.153645833333333, 0.127314814814815, 0.134615384615385, 0.134259259259259, 0.172619047619048, 0.161458333333333, 0.130000000000000, 0.112500000000000, 0.136574074074074, 0.146739130434783, 0.144230769230769, 0.172619047619048, 0.134259259259259, 0.0996093750000000, 0.0989583333333333, 0.0970394736842105, 0.0919117647058824, 0.0846774193548387, 0.0681818181818182, 0.0899390243902439, 0.0838815789473684, 0.0733695652173913, 0.0843023255813954, 0.0755208333333333, 0.111607142857143, 0.0614224137931034, 0.0580357142857143, 0.0625000000000000, 0.0428571428571429, 0.0463709677419355, 0.0613425925925926, 0.0433333333333333, 0.0338235294117647, 0.0463709677419355, 0.0411184210526316, 0.0357142857142857, 0.0476973684210526, 0.0260922330097087, 0.0303217821782178, 0.0262096774193548, 0.0327743902439024, 0.0284090909090909, 0.0228658536585366, 0.0171632124352332, 0.0158730158730159, 0.0218949044585987, 0.0160519125683060, 0.0119617224880383, 0.0215231788079470, 0.0152173913043478, 0.0130319148936170, 0.0135467980295567, 0.0125523012552301, 0.00828530259365994, 0.0104489164086687, 0.00825777202072539, 0.00653206650831354, 0.00887345679012346, 0.00479890310786106, 0.00428464977645306, 0.00417258522727273, 0.00402002427184466, 0.00488826815642458, 0.00361881785283474, 0.00253150315031503, 0.00201215505913272, 0.00206846203763790, 0.00191885964912281, 0.00184748427672956, 0.00201376684241359, 0.00233446519524618, 0.00107168916453849, 0.00148398674765323, 0.000798900118906064, 0.00104347826086957, 0.000859845227858985, 0.00114207400639561, 0.000665646952186721, 0.000462739417350716, 0.000401383228356181, 0.000247591006423983, 0.000642216878006122, 0.000257641262819224, 0.000425833924769340, 0.000244629033660955, 0.000153177931485213, 0.000132307441784726, 0.000155689517736150, 9.95352314092564e-05, 0.000100127341439369, 7.02934621873243e-05, 6.57216234252088e-05, 4.14683398240300e-05, 4.61240127498548e-05, 3.34697624603144e-05, 2.67322497861420e-05, 3.09018991943693e-05, 1.79618075250520e-05, 2.07338396997740e-05, 1.41709349038121e-05, 1.34459761364953e-05]

esno_ldpc_16_10_bcjr = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0, 6.4]
fer_ldpc_16_10_bcjr = [1.0, 1.0, 1.0, 1.0, 0.9090909090909091, 1.0, 0.7142857142857143, 0.7692307692307693, 0.9090909090909091, 1.0, 0.7692307692307693, 0.8333333333333334, 0.7692307692307693, 0.7692307692307693, 0.8333333333333334, 0.37037037037037035, 0.7692307692307693, 0.45454545454545453, 0.3225806451612903, 0.25, 0.3225806451612903, 0.30303030303030304, 0.2857142857142857, 0.17543859649122806, 0.07575757575757576, 0.04484304932735426, 0.062111801242236024, 0.021231422505307854, 0.019417475728155338, 0.01422475106685633, 0.009074410163339383, 0.010040160642570281]
ber_ldpc_16_10_bcjr = [0.0625, 0.0625, 0.0625, 0.0625, 0.056818181818181816, 0.0625, 0.044642857142857144, 0.04807692307692308, 0.056818181818181816, 0.0625, 0.04807692307692308, 0.052083333333333336, 0.04807692307692308, 0.04807692307692308, 0.052083333333333336, 0.023148148148148147, 0.04807692307692308, 0.028409090909090908, 0.020161290322580645, 0.015625, 0.020161290322580645, 0.01893939393939394, 0.017857142857142856, 0.010964912280701754, 0.004734848484848485, 0.002802690582959641, 0.0038819875776397515, 0.001326963906581741, 0.0012135922330097086, 0.0008890469416785206, 0.0005671506352087115, 0.0006275100401606426]

esno_ldpc_16_10_bcjr_v2 = [-4, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, -0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6]
fer_ldpc_16_10_bcjr_v2 = [0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 1.0, 0.8333333333333334, 0.7142857142857143, 1.0, 0.625, 0.7142857142857143, 0.8333333333333334, 0.2777777777777778, 0.8333333333333334, 0.5, 0.3333333333333333, 0.2631578947368421, 0.21739130434782608, 0.1724137931034483, 0.14285714285714285, 0.18518518518518517, 0.08771929824561403, 0.05263157894736842, 0.00847457627118644, 0.006738544474393531, 0.0035739814152966403, 0.0003619254433586681]
ber_ldpc_16_10_bcjr_v2 = [0.052083333333333336, 0.052083333333333336, 0.052083333333333336, 0.0625, 0.052083333333333336, 0.044642857142857144, 0.0625, 0.0390625, 0.044642857142857144, 0.052083333333333336, 0.017361111111111112, 0.052083333333333336, 0.03125, 0.020833333333333332, 0.01644736842105263, 0.01358695652173913, 0.010775862068965518, 0.008928571428571428, 0.011574074074074073, 0.005482456140350877, 0.003289473684210526, 0.005296610169491525, 0.0004211590296495957, 0.00022337383845604002, 2.2620340209916757e-05]

esno_ldpc_16_10_bcjr_v2 = [-4.9, -4.5, -4.1, -3.7, -3.3, -2.9, -2.5, -2.1, -1.7, -1.3, -0.9, -0.5, -0.1, 0.3, 0.7, 1.1, 1.5, 1.9, 2.3, 2.7, 3.1, 3.5, 3.9, 4.3, 4.7, 5.1, 5.5, 5.9]
fer_ldpc_16_10_bcjr_v2 = [1.0, 1.0, 1.0, 1.0, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.8333333333333334, 0.7142857142857143, 0.8333333333333334, 0.8333333333333334, 0.5, 0.7142857142857143, 0.4166666666666667, 0.3125, 0.2631578947368421, 0.4166666666666667, 0.1724137931034483, 0.20833333333333334, 0.09259259259259259, 0.07747126436781609, 0.06329113924050633, 0.050240963855421686, 0.012468827930174564, 0.004240882103477523, 0.0006351626016260162, 0.0001050626016260143]
ber_ldpc_16_10_bcjr_v2 = [0.0625, 0.0625, 0.0625, 0.0625, 0.052083333333333336, 0.052083333333333336, 0.052083333333333336, 0.052083333333333336, 0.052083333333333336, 0.044642857142857144, 0.052083333333333336, 0.052083333333333336, 0.03125, 0.044642857142857144, 0.026041666666666668, 0.01953125, 0.01644736842105263, 0.026041666666666668, 0.010775862068965518, 0.013020833333333334, 0.005787037037037037, 0.0035919540229885057, 0.003955696202531646, 0.0037650602409638554, 0.0007793017456359103, 0.0002650551314673452, 3.9697662601626015e-05, 1.0697662601626015e-05]


# -----------------------BCH(15,7) original-------------------------
esno_bch_15_7 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2]
fer_bch_15_7 = [0.967741935483871, 0.967741935483871, 0.967741935483871, 0.8823529411764706, 0.8571428571428571, 0.7142857142857143, 0.8823529411764706, 0.6976744186046512, 0.6, 0.625, 0.410958904109589, 0.46153846153846156, 0.33707865168539325, 0.37037037037037035, 0.234375, 0.18292682926829268, 0.16304347826086957, 0.10600706713780919, 0.08310249307479224, 0.06465517241379311, 0.04593406593406594, 0.03787878787878788, 0.017899761336515514, 0.01430615164520744, 0.007234145165179648, 0.003906758692538091, 0.0018176310209027568, 0.0011545566502463055, 0.0005786811203927681]

#----------------------BCH(15,7) supercode-----------------------------------------------------
esno_bch_15_7_super_iter_2 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2]
fer_bch_15_7_super_iter_2 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.7692307692307693, 0.9090909090909091, 0.625, 0.8333333333333334, 0.7142857142857143, 0.5263157894736842, 0.37037037037037035, 0.4, 0.35714285714285715, 0.43478260869565216, 0.2777777777777778, 0.18181818181818182, 0.11363636363636363, 0.12658227848101267, 0.10752688172043011, 0.04608294930875576, 0.036101083032490974, 0.029850746268656716, 0.02079002079002079, 0.013422818791946308, 0.007455746268656716]

esno_bch_15_7_super_iter_5 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2]
fer_bch_15_7_super_iter_5 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9375, 0.7142857142857143, 0.6818181818181818, 0.5357142857142857, 0.6818181818181818, 0.28846153846153844, 0.5, 0.26785714285714285, 0.2542372881355932, 0.20833333333333334, 0.15789473684210525, 0.1595744680851064, 0.12195121951219512, 0.04807692307692308, 0.06437768240343347, 0.04, 0.02094972067039106, 0.018867924528301886, 0.008710801393728223, 0.005048805116122518, 0.0027752081406105457, 0.001010801393728513]

esno_bch_15_7_super_iter_8 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8]
fer_bch_15_7_super_iter_8 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5714285714285714, 0.5714285714285714, 0.27586206896551724, 0.5, 0.21621621621621623, 0.47058823529411764, 0.32, 0.18181818181818182, 0.18181818181818182, 0.1951219512195122, 0.1568627450980392, 0.125, 0.061068702290076333, 0.10526315789473684, 0.044444444444444446, 0.023323615160349854, 0.013582342954159592, 0.008456659619450317, 0.006477732793522267, 0.002191780821917808]

esno_bch_15_7_super_m_3_iter_2 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0, 6.4, 6.8, 7.2]
fer_bch_15_7_super_m_3_iter_2 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9782608695652174, 0.7758620689655172, 0.7258064516129032, 0.8181818181818182, 0.6818181818181818, 0.5421686746987951, 0.6428571428571429, 0.5056179775280899, 0.45454545454545453, 0.42452830188679247, 0.36585365853658536, 0.26785714285714285, 0.2616279069767442, 0.22277227722772278, 0.15100671140939598, 0.14150943396226415, 0.11221945137157108, 0.0706436420722135, 0.07131537242472266, 0.0400355871886121, 0.031141868512110725, 0.019329896907216496, 0.009475679090334808, 0.007302823758519961, 0.0044634001190240035, 0.002542372881355932, 0.0010032326385018392]

esno_bch_15_7_super_m_3_iter_3 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0, 6.4]
fer_bch_15_7_super_m_3_iter_3 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8928571428571429, 0.5555555555555556, 0.625, 0.5813953488372093, 0.5102040816326531, 0.43103448275862066, 0.36764705882352944, 0.32051282051282054, 0.2358490566037736, 0.20491803278688525, 0.23809523809523808, 0.1865671641791045, 0.10869565217391304, 0.10822510822510822, 0.0847457627118644, 0.06218905472636816, 0.04091653027823241, 0.024390243902439025, 0.016118633139909737, 0.008928571428571428, 0.007587253414264037, 0.003073518564052127, 0.0017092848352249419, 0.000518571428571428]

esno_bch_15_7_super_m_3_iter_5 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6]
fer_bch_15_7_super_m_3_iter_5 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9259259259259259, 0.6097560975609756, 0.6097560975609756, 0.5681818181818182, 0.49019607843137253, 0.43859649122807015, 0.29069767441860467, 0.29069767441860467, 0.22935779816513763, 0.21739130434782608, 0.21123893805309736, 0.18, 0.12376237623762376, 0.08250825082508251, 0.05399568034557235, 0.04734848484848485, 0.02883506343713956, 0.016512549537648614, 0.009567521367521368, 0.006654245408570668, 0.004900039200313603, 0.0020464963981663394, 0.00065452136752168]

esno_bch_15_7_super_m_4_iter_2 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0, 6.4, 6.8, 7.2]
fer_bch_15_7_super_m_4_iter_2 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8928571428571429, 0.8333333333333334, 0.7575757575757576, 0.7142857142857143, 0.7352941176470589, 0.6944444444444444, 0.5434782608695652, 0.5208333333333334, 0.5555555555555556, 0.4166666666666667, 0.46296296296296297, 0.43103448275862066, 0.36764705882352944, 0.3125, 0.23148148148148148, 0.26595744680851063, 0.15625, 0.16447368421052633, 0.10683760683760683, 0.07183908045977011, 0.06082725060827251, 0.05387931034482758, 0.03770739064856712, 0.02158894645941278, 0.016578249336870028, 0.0063484002031488065, 0.004567044208987943]

esno_bch_15_7_super_m_4_iter_5 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0, 6.4]
fer_bch_15_7_super_m_4_iter_5 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9615384615384616, 0.6756756756756757, 0.5319148936170213, 0.6410256410256411, 0.38461538461538464, 0.45454545454545453, 0.423728813559322, 0.45454545454545453, 0.390625, 0.30864197530864196, 0.28735632183908044, 0.1773049645390071, 0.16891891891891891, 0.12755102040816327, 0.11363636363636363, 0.05319148936170213, 0.04604051565377532, 0.033156498673740056, 0.02129471890971039, 0.013150973172014729, 0.00885896527285613, 0.005978000956480153, 0.0023240680487124662, 0.0012880622391673966, 0.00077800056480153]

esno_bch_15_7_super_m_4_iter_8 = [-6, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6]
fer_bch_15_7_super_m_4_iter_8 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9615384615384616, 0.7575757575757576, 0.64642857142857145, 0.4807692307692308, 0.43859649122807015, 0.43859649122807015, 0.3333333333333333, 0.36764705882352944, 0.25252525252525254, 0.20491803278688525, 0.15822784810126583, 0.10460251046025104, 0.08619883040935672, 0.0668695652173913, 0.05230125523012552, 0.03828483920367534, 0.02612330198537095, 0.023299161230195712, 0.013082155939298797, 0.007086167800453515, 0.0031605562579013905, 0.001414947501049979, 0.0007605562579013905]

# plt.plot(esno_bch_15_7, gaussian_filter1d(fer_bch_15_7, sigma=0.8).tolist(), label="BCJR classic", alpha=1, linewidth=2)
# plt.plot(esno_bch_15_7_super_m_3_iter_2, gaussian_filter1d(fer_bch_15_7_super_m_3_iter_2, sigma=0.8).tolist(), label="super m=3, i=2", alpha=1, linewidth=2)
# plt.plot(esno_bch_15_7_super_m_3_iter_3, gaussian_filter1d(fer_bch_15_7_super_m_3_iter_3, sigma=0.8).tolist(), label="super m=3, i=3", alpha=1, linewidth=2)
# plt.plot(esno_bch_15_7_super_m_3_iter_5, gaussian_filter1d(fer_bch_15_7_super_m_3_iter_5, sigma=0.8).tolist(), label="super m=3, i=5", alpha=1, linewidth=2)

esno_hamming = [-10, -9.6, -9.2, -8.8, -8.4, -8.0, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4, 4.8, 5.2, 5.6, 6.0]
fer_hamming = [0.9803921568627451, 0.9615384615384616, 0.9259259259259259, 0.9803921568627451, 0.9259259259259259, 0.9259259259259259, 0.9615384615384616, 0.9433962264150944, 0.9259259259259259, 0.8333333333333334, 0.8771929824561403, 0.847457627118644, 0.7692307692307693, 0.7692307692307693, 0.7352941176470589, 0.6578947368421053, 0.6756756756756757, 0.5952380952380952, 0.5813953488372093, 0.49019607843137253, 0.45871559633027525, 0.4166666666666667, 0.3048780487804878, 0.2717391304347826, 0.24509803921568626, 0.2994011976047904, 0.24752475247524752, 0.17985611510791366, 0.12886597938144329, 0.12376237623762376, 0.09208103130755065, 0.08361204013377926, 0.06535947712418301, 0.04382120946538125, 0.031826861871419476, 0.0175561797752809, 0.01615508885298869, 0.01079447322970639, 0.005594092638174088, 0.004313319530710835, 0.0019697447210841475]
ber_hamming = [0.3417366946778711, 0.35439560439560436, 0.36243386243386244, 0.36414565826330536, 0.35714285714285715, 0.34391534391534395, 0.3516483516483516, 0.34231805929919135, 0.31216931216931215, 0.28095238095238095, 0.2631578947368421, 0.2808716707021792, 0.2197802197802198, 0.28791208791208794, 0.25630252100840334, 0.2556390977443609, 0.21235521235521235, 0.22108843537414968, 0.23920265780730898, 0.1792717086834734, 0.19003931847968547, 0.15595238095238095, 0.12369337979094076, 0.11413043478260869, 0.10434173669467786, 0.1317365269461078, 0.10891089108910891, 0.08067831449126413, 0.0585419734904271, 0.05551626591230551, 0.04130491975795843, 0.03774486383182036, 0.029318394024276374, 0.019531739075998495, 0.014185687005546966, 0.007574237560192617, 0.007154396492037849, 0.004780409573155687, 0.002525333248090017, 0.0018978605935127675, 0.0008554319931565441]


# -----------------------BCH(31,26) original-------------------------
esno_bch_31_26 = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0, 8.2, 8.4, 8.6, 8.8, 9.0]
fer_bch_31_26 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 1.0, 1.0, 0.9803921568627451, 1.0, 0.9615384615384616, 0.9615384615384616, 0.9615384615384616, 0.9259259259259259, 0.9259259259259259, 0.9090909090909091, 0.9090909090909091, 0.8771929824561403, 0.8620689655172413, 0.78125, 0.847457627118644, 0.684931506849315, 0.78125, 0.7352941176470589, 0.704225352112676, 0.6578947368421053, 0.684931506849315, 0.4132231404958678, 0.42016806722689076, 0.42016806722689076, 0.43859649122807015, 0.3875968992248062, 0.2857142857142857, 0.25510204081632654, 0.20242914979757085, 0.18726591760299627, 0.16233766233766234, 0.12626262626262627, 0.15060240963855423, 0.07451564828614009, 0.06666666666666667, 0.043327556325823226, 0.03033980582524272, 0.03136762860727729, 0.01906941266209001, 0.017768301350390904, 0.009437523593808984, 0.006992029086841001, 0.0050110242533573865, 0.003963221306277742, 0.00180583646344987, 0.0012724588995775437, 0.0006315364017581974, 0.0005092375695109283, 0.0002948999994102, 0.00012020299882441467, 9.033407347050864e-05]
ber_bch_31_26 = [0.25225806451612903, 0.26387096774193547, 0.24838709677419357, 0.25806451612903225, 0.24967741935483873, 0.2335483870967742, 0.23548387096774193, 0.22, 0.23677419354838708, 0.21741935483870967, 0.1993548387096774, 0.2064516129032258, 0.21419354838709675, 0.1929032258064516, 0.17330803289057556, 0.17677419354838708, 0.1993548387096774, 0.1644528779253637, 0.18516129032258064, 0.1544665012406948, 0.151985111662531, 0.1674937965260546, 0.14277180406212664, 0.14336917562724014, 0.1343108504398827, 0.13255131964809383, 0.134125636672326, 0.13125695216907676, 0.11088709677419355, 0.1273920174958994, 0.09323906319045515, 0.10483870967741936, 0.09819734345351044, 0.10268059972739664, 0.0904074702886248, 0.08926204153778171, 0.05331911490269261, 0.05692599620493359, 0.05394415830848468, 0.055178268251273345, 0.04801200300075019, 0.03447004608294931, 0.03127057274522712, 0.025075094684602325, 0.02247191011235955, 0.01989945538332635, 0.014418377321603129, 0.017100660707345512, 0.008413057064564205, 0.007182795698924731, 0.004807961089059094, 0.0032688694018164735, 0.0033796090176872948, 0.002251420978814498, 0.0019143911777517938, 0.0010472606826678358, 0.0007668677062986904, 0.0005334316140670766, 0.00041422054943031887, 0.00018873903682508318, 0.00013463436098755944, 6.356108301566373e-05, 5.158083768594563e-05, 2.9870516069291227e-05, 1.2330501169730279e-05, 8.858567204849878e-06]

# plt.plot(esno_bch_31_26, fer_bch_31_26, label="BCJR(31,26)", alpha=1, linewidth=2)
# plt.plot(esno_bch_31_26, gaussian_filter1d(fer_bch_31_26, sigma=1).tolist(), label="BCJR", alpha=1, linewidth=2)

#----------------------BCH(31,26) supercode-----------------------------------------------------
esno_bch_31_26_supercode_2_matrix_5_iter = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0, 8.2, 8.4, 8.6, 8.8, 9.0, ] #9.2
fer_bch_31_26_supercode_2_matrix_5_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9523809523809523, 1.0, 1.0, 1.0, 1.0, 0.9523809523809523, 0.9523809523809523, 1.0, 0.9523809523809523, 0.9523809523809523, 1.0, 0.9523809523809523, 0.8695652173913043, 1.0, 0.9090909090909091, 0.9523809523809523, 0.9523809523809523, 0.8, 0.9523809523809523, 0.8, 0.8333333333333334, 0.8, 0.6060606060606061, 0.8, 0.8333333333333334, 0.5128205128205128, 0.7407407407407407, 0.6666666666666666, 0.46511627906976744, 0.4, 0.37037037037037035, 0.38461538461538464, 0.3448275862068966, 0.23529411764705882, 0.2222222222222222, 0.20408163265306123, 0.18518518518518517, 0.17699115044247787, 0.11695906432748537, 0.11363636363636363, 0.08196721311475409, 0.07874015748031496, 0.04987531172069826, 0.03898635477582846, 0.022935779816513763, 0.02098635886673662, 0.01652892561983471, 0.006355258976803305, 0.0033938571186153065, 0.003009328919650918, 0.0025037556334501754, 0.0010164151039284443, 0.0007083407118824154, 0.00045333998231974066, 0.00020811221410584586, 0.0001700550127966397, ] # 0.00028693169590978865
ber_bch_31_26_supercode_2_matrix_5_iter = [0.7338709677419355, 0.7387096774193548, 0.75, 0.7516129032258065, 0.7629032258064516, 0.21774193548387094, 0.21129032258064515, 0.2661290322580645, 0.2274193548387097, 0.18064516129032257, 0.21812596006144394, 0.2274193548387097, 0.21774193548387094, 0.2, 0.2, 0.1674347158218126, 0.18740399385560677, 0.17580645161290323, 0.17665130568356374, 0.1858678955453149, 0.1774193548387097, 0.1781874039938556, 0.16690042075736325, 0.16774193548387098, 0.14369501466275658, 0.1597542242703533, 0.16436251920122888, 0.12387096774193548, 0.13671274961597543, 0.10451612903225806, 0.10887096774193548, 0.11096774193548388, 0.09286412512218964, 0.1096774193548387, 0.11155913978494623, 0.06451612903225806, 0.09557945041816009, 0.08924731182795699, 0.054013503375843964, 0.05290322580645161, 0.04838709677419355, 0.042183622828784115, 0.03615127919911012, 0.025426944971537, 0.02186379928315412, 0.02369980250164582, 0.019115890083632018, 0.018840993434199257, 0.012261837389171854, 0.011730205278592375, 0.008461131676361713, 0.007747015494030988, 0.004826643069744992, 0.004275922781865057, 0.0022565847883989345, 0.0019970889889313883, 0.0017861903492402025, 0.0005535225560441588, 0.0002846460809161225, 0.00028637162299903897, 0.00024633724780719464, 8.196895999422939e-05, 6.055170601575487e-05, 4.3140417672362425e-05, 1.544058362720792e-05, 1.61826544435512e-05, 2.6379204301383797e-05]
# plt.plot(esno_bch_31_26_supercode_2_matrix_5_iter, fer_bch_31_26_supercode_2_matrix_5_iter, label="BCJR-supercode-2m-5i", alpha=1, linewidth=2)
# plt.plot(esno_bch_31_26_supercode_2_matrix_5_iter, gaussian_filter1d(fer_bch_31_26_supercode_2_matrix_5_iter, sigma=1).tolist(), label="BCJR-supercode-2m-5i", alpha=1, linewidth=2)

esno_bch_31_26_supercode_2_matrix_2_iter = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0, 8.2, 8.4, 8.6, 8.8, 9.0, 9.2, 9.4, 9.6, 9.8]
fer_bch_31_26_supercode_2_matrix_2_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9375, 1.0, 1.0, 1.0, 0.967741935483871, 0.967741935483871, 0.9375, 0.9090909090909091, 0.9090909090909091, 0.9375, 0.8333333333333334, 1.0, 0.8823529411764706, 0.8571428571428571, 0.7317073170731707, 0.7142857142857143, 0.6666666666666666, 0.7317073170731707, 0.5660377358490566, 0.5263157894736842, 0.5357142857142857, 0.5660377358490566, 0.42857142857142855, 0.4411764705882353, 0.32967032967032966, 0.3191489361702128, 0.30927835051546393, 0.17543859649122806, 0.1744186046511628, 0.11194029850746269, 0.10830324909747292, 0.08130081300813008, 0.07246376811594203, 0.04739336492890995, 0.056074766355140186, 0.05263157894736842, 0.02680965147453083, 0.015455950540958269, 0.013181019332161687, 0.009933774834437087, 0.005297545470598622, 0.003837298541826554, 0.0022294887039239, 0.0014642717688402968, 0.0010755001075500108, 0.0007862459377293217, 0.00036847794045396484, 0.0002552822144881166, 0.00013317234276785398, 7.136213667752163e-05, 3.686101431681796e-05]
ber_bch_31_26_supercode_2_matrix_2_iter = [0.721505376344086, 0.721505376344086, 0.743010752688172, 0.7365591397849462, 0.7591397849462366, 0.2623655913978495, 0.23010752688172043, 0.23333333333333334, 0.22795698924731184, 0.23118279569892472, 0.2118279569892473, 0.23010752688172043, 0.2075268817204301, 0.2096774193548387, 0.2064516129032258, 0.1903225806451613, 0.1967741935483871, 0.17741935483870966, 0.15376344086021507, 0.1844758064516129, 0.17096774193548386, 0.17526881720430107, 0.16559139784946236, 0.14672216441207078, 0.14776274713839752, 0.15625, 0.1270772238514174, 0.13782991202346043, 0.12096774193548387, 0.11559139784946236, 0.13225806451612904, 0.12144212523719165, 0.1032258064516129, 0.07474429583005507, 0.08218125960061444, 0.07598566308243727, 0.08025177025963809, 0.06877662811929397, 0.04867006225240521, 0.05587557603686636, 0.05295191722458917, 0.04331797235023042, 0.04933586337760911, 0.03403048564338887, 0.02916952642415923, 0.02926504822081809, 0.016034710431993962, 0.017066766691672917, 0.009749638902262879, 0.00978222895073949, 0.007518139697526008, 0.00638927847904005, 0.004025887988584824, 0.004401567681640036, 0.004640633842671194, 0.002248551413992908, 0.0011799704176430508, 0.0008362152049435909, 0.0006729331339457381, 0.00035886598349216476, 0.0002640721577170962, 0.00013185148249012313, 8.974568905795367e-05, 6.476129679871032e-05, 4.56529899326703e-05, 2.3376557512670887e-05, 1.4273844250948456e-05, 7.73258764458507e-06, 4.06687445581575e-06, 2.1403169603313654e-06]
# plt.plot(esno_bch_31_26_supercode_2_matrix_2_iter, fer_bch_31_26_supercode_2_matrix_2_iter, label="BCJR-supercode-2m-2i", alpha=1, linewidth=2)
# plt.plot(esno_bch_31_26_supercode_2_matrix_2_iter, gaussian_filter1d(fer_bch_31_26_supercode_2_matrix_2_iter, sigma=1).tolist(), label="BCJR-supercode-2m-2i", alpha=1, linewidth=2)

#-----------------------BCH(31,21) original----------------------------------------------------------------
esno_bch_31_21 = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0]
fer_bch_31_21 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 1.0, 0.9615384615384616, 0.9803921568627451, 0.9433962264150944, 0.8620689655172413, 0.8771929824561403, 0.9615384615384616, 0.9090909090909091, 0.8620689655172413, 0.8064516129032258, 0.7352941176470589, 0.7575757575757576, 0.7246376811594203, 0.746268656716418, 0.6097560975609756, 0.6944444444444444, 0.6024096385542169, 0.49019607843137253, 0.4065040650406504, 0.47619047619047616, 0.3597122302158273, 0.3472222222222222, 0.2777777777777778, 0.2777777777777778, 0.25510204081632654, 0.15625, 0.10683760683760683, 0.12345679012345678, 0.1366120218579235, 0.08417508417508418, 0.05656108597285068, 0.06821282401091405, 0.0297441998810232, 0.029994001199760048, 0.014898688915375448, 0.018214936247723135, 0.010034115994380895, 0.006994963626189144, 0.0053671103477887505, 0.00218435998252512, 0.0014583211806568279, 0.0011017826843833323]
ber_bch_31_21 = [0.26129032258064516, 0.25870967741935486, 0.2606451612903226, 0.24387096774193548, 0.25548387096774194, 0.24967741935483873, 0.24451612903225808, 0.23935483870967741, 0.21948134092346616, 0.2167741935483871, 0.21029776674937967, 0.21062618595825428, 0.17772367620206939, 0.185761957730812, 0.1697792869269949, 0.22332506203473945, 0.19178885630498535, 0.17130144605116795, 0.1696149843912591, 0.15702087286527514, 0.16715542521994137, 0.14258999532491817, 0.15888300433317284, 0.12903225806451613, 0.13664874551971326, 0.11853867081228138, 0.1002530044275775, 0.0826121164437451, 0.09615975422427037, 0.07588767695521002, 0.07123655913978494, 0.05412186379928315, 0.05878136200716846, 0.053159973666886115, 0.02933467741935484, 0.020471464019851116, 0.02493030665073676, 0.026529173276925788, 0.016346258281742153, 0.010874324916070648, 0.012498349689741672, 0.005872080750705225, 0.005805290554792268, 0.0027971086931446805, 0.0034079558140901346, 0.0017543518932111113, 0.0012816578515082045, 0.0009764678181138244, 0.00038050141631082733, 0.00026437951726746364, 0.00018836929765263423]
# plt.plot(esno_bch_31_21, fer_bch_31_21, label="BCJR(31,21)", alpha=1, linewidth=2)
# plt.plot(esno_bch_31_21, gaussian_filter1d(fer_bch_31_21, sigma=0.6).tolist(), label="BCJR", alpha=1, linewidth=2)

#-----------------------BCH(31,16) original----------------------------------------------------------------
esno_bch_31_16 = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6]
fer_bch_31_16 = [0.9803921568627451, 1.0, 1.0, 0.9803921568627451, 0.9803921568627451, 0.9090909090909091, 0.8928571428571429, 0.9259259259259259, 0.847457627118644, 0.8928571428571429, 0.7575757575757576, 0.6578947368421053, 0.6578947368421053, 0.7692307692307693, 0.6172839506172839, 0.6756756756756757, 0.625, 0.49504950495049505, 0.45871559633027525, 0.33112582781456956, 0.47619047619047616, 0.3472222222222222, 0.3048780487804878, 0.2617801047120419, 0.2066115702479339, 0.20491803278688525, 0.16722408026755853, 0.12690355329949238, 0.1358695652173913, 0.11494252873563218, 0.08116883116883117, 0.052083333333333336, 0.044682752457551385, 0.03875968992248062, 0.02328830926874709, 0.025303643724696356, 0.012768130745658836, 0.00929195316855603, 0.005719514985129261, 0.0039575747981636855, 0.003491132523390588, 0.0026093309675399227, 0.0010931829113647296, 0.0008504269143109841, 0.0005133101317153798, 0.00031656990180001644, 0.00021579815104144187, 0.00010269323272135013, 3.63998891825596e-05]
ber_bch_31_16 = [0.25743200506008856, 0.24774193548387097, 0.2535483870967742, 0.24161922833649588, 0.2245414294750158, 0.224633431085044, 0.21831797235023043, 0.2084826762246117, 0.2192454893384363, 0.228110599078341, 0.17595307917888564, 0.16468590831918506, 0.16893039049235992, 0.18858560794044665, 0.1461569095977698, 0.14559721011333915, 0.1588709677419355, 0.1267965506228042, 0.11837821840781296, 0.0826746421704764, 0.11582181259600616, 0.08781362007168458, 0.07631785995279307, 0.062151663570342845, 0.05291922154092242, 0.05222104706504495, 0.04498867191714316, 0.030702472572457836, 0.03357293127629734, 0.030626622172784574, 0.020684960201089234, 0.013004032258064516, 0.01109861915881115, 0.00975243810952738, 0.0058145649593581445, 0.006203473945409429, 0.003130251408613134, 0.002278027228420188, 0.001442793780119704, 0.000947264677495953, 0.0008468811798676523, 0.000622872553541788, 0.0002616586194298804, 0.00020081048428246463, 0.00012186976030403855, 7.373015132245545e-05, 5.067775934134506e-05, 2.504389804430345e-05, 8.545493696980838e-06]
# plt.plot(esno_bch_31_16, fer_bch_31_16, label="BCJR(31,16)", alpha=1, linewidth=2)
plt.plot(esno_bch_31_16, gaussian_filter1d(fer_bch_31_16, sigma=0.6).tolist(), label="BCJR", alpha=1, linewidth=2)

#-----------------------BCH(31,16) supercode----------------------------------------------------------------
esno_bch_31_16_supercode_2_matrix_2_iter = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6]
fer_bch_31_16_supercode_2_matrix_2_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9433962264150944, 1.0, 0.9615384615384616, 0.9615384615384616, 0.9615384615384616, 0.9259259259259259, 0.8333333333333334, 0.9433962264150944, 0.8771929824561403, 0.8333333333333334, 0.847457627118644, 0.78125, 0.7575757575757576, 0.6756756756756757, 0.7246376811594203, 0.49019607843137253, 0.6493506493506493, 0.4716981132075472, 0.5, 0.4065040650406504, 0.3937007874015748, 0.3968253968253968, 0.3246753246753247, 0.25906735751295334, 0.3067484662576687, 0.23148148148148148, 0.16666666666666666, 0.10683760683760683, 0.12853470437017994, 0.16286644951140064, 0.10204081632653061, 0.06631299734748011, 0.07418397626112759, 0.04668534080298786, 0.031387319522912745, 0.025906735751295335, 0.011614401858304297, 0.00963020030816641, 0.00737571913261543, 0.004857198367981349, 0.003587315253264457, 0.002336885399140026, 0.0014092446448703494, 0.0010385510136257893, 0.0005687440992799699, 0.0003266671457784805, 0.00017388219828830365, 0.00009161415683553088]
ber_bch_31_16_supercode_2_matrix_2_iter = [0.7109677419354838, 0.752258064516129, 0.7296774193548388, 0.724516129032258, 0.6780645161290323, 0.44, 0.2702373706634206, 0.33096774193548384, 0.25496277915632753, 0.2487593052109181, 0.25868486352357317, 0.25925925925925924, 0.22956989247311826, 0.24528301886792453, 0.24448217317487267, 0.21774193548387097, 0.2241662110442865, 0.1905241935483871, 0.18621700879765396, 0.16477768090671316, 0.14118747078073868, 0.1008855154965212, 0.11897779639715124, 0.0934266585514303, 0.09387096774193548, 0.07867820613690008, 0.07264414528829058, 0.07782898105478751, 0.053414327607876, 0.044960722045796424, 0.044725905402731046, 0.039874551971326166, 0.02763440860215054, 0.0155776123518059, 0.018658263537606766, 0.02542818114952191, 0.015404871626069783, 0.009198254470779498, 0.010529338566095529, 0.006204632390590645, 0.0036652289249336817, 0.0033595186361357176, 0.0013937282229965157, 0.0009257418360753516, 0.000737571913261543, 0.00047631880769881613, 0.000333273159012956, 0.0002140888559212153, 0.00013546932392624652, 8.911437729821288e-05, 4.9535776388900604e-05, 2.6976383651384195e-05, 1.3574029672828865e-05, 6.715766380873497e-06]
# plt.plot(esno_bch_31_16_supercode_2_matrix_2_iter, fer_bch_31_16_supercode_2_matrix_2_iter, label="BCJR(31,16) supercode(2,2)", alpha=1, linewidth=2)
plt.plot(esno_bch_31_16_supercode_2_matrix_2_iter, gaussian_filter1d(fer_bch_31_16_supercode_2_matrix_2_iter, sigma=1).tolist(), label="BCJR(31,16) supercode(2,2)", alpha=1, linewidth=2)

esno_bch_31_16_supercode_3_matrix_2_iter = [-4, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2, 7.4, 7.6, 7.8, 8.0, 8.2, 8.4]
fer_bch_31_16_supercode_3_matrix_2_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 0.9803921568627451, 0.9803921568627451, 0.9803921568627451, 0.9615384615384616, 0.9803921568627451, 0.9433962264150944, 0.9615384615384616, 0.9433962264150944, 0.9090909090909091, 0.8928571428571429, 0.847457627118644, 0.8771929824561403, 0.8333333333333334, 0.7575757575757576, 0.8064516129032258, 0.6944444444444444, 0.6944444444444444, 0.684931506849315, 0.6578947368421053, 0.5747126436781609, 0.5952380952380952, 0.45871559633027525, 0.6024096385542169, 0.5263157894736842, 0.42735042735042733, 0.3875968992248062, 0.29411764705882354, 0.390625, 0.30120481927710846, 0.2403846153846154, 0.23255813953488372, 0.19607843137254902, 0.14705882352941177, 0.13054830287206268, 0.0998003992015968, 0.08695652173913043, 0.06675567423230974, 0.04950495049504951, 0.03695491500369549, 0.028296547821165818, 0.021249468763280918, 0.01669449081803005, 0.012342631449024932, 0.010229132569558102, 0.006745817593092283, 0.0034057625502349974, 0.0029954469206805653, 0.001737136504186499, 0.0011840765387074622, 0.0007757711164897909, 0.00035592001765363286, 0.00022197853911483836, 0.00016204146316959583, 0.00014570335379979776, 7.09985232307168e-05, 4.9756442215355835e-05]
ber_bch_31_16_supercode_3_matrix_2_iter = [0.7419354838709676, 0.7483870967741936, 0.7490322580645161, 0.76, 0.7412903225806451, 0.4232258064516129, 0.265022137887413, 0.25743200506008856, 0.24604680581910185, 0.2593295382669197, 0.22766749379652604, 0.2314990512333966, 0.2361533779671333, 0.23138957816377173, 0.20754716981132076, 0.1970674486803519, 0.20564516129032256, 0.15965008201202843, 0.16921335597057158, 0.14838709677419354, 0.1295210166177908, 0.1441207075962539, 0.1124551971326165, 0.117831541218638, 0.1117984975695979, 0.09847198641765705, 0.0871338524286244, 0.08755760368663594, 0.06540396567031666, 0.0746210649047804, 0.061799660441426145, 0.05679625034463744, 0.05126281570392598, 0.03795066413662239, 0.04788306451612903, 0.032452390205985227, 0.025434243176178657, 0.025206301575393848, 0.01644528779253637, 0.011954459203036052, 0.010022740672113199, 0.007275771038568025, 0.006115007012622721, 0.005297385761660709, 0.003257745129351645, 0.002288820542164366, 0.0020811654526534857, 0.0013298054645408059, 0.0007970273035704669, 0.000637039042530319, 0.0005477535504989176, 0.00035687551137649496, 0.0001362305020093999, 0.00012175042322766169, 8.405499213805641e-05, 5.34744243287241e-05, 3.103084465959163e-05, 1.1710916709893728e-05, 9.165565486032037e-06, 5.749858370534046e-06, 5.2641211695410806e-06, 2.3818859406434022e-06, 1.8190527261527939e-06]
# plt.plot(esno_bch_31_16_supercode_3_matrix_2_iter, fer_bch_31_16_supercode_3_matrix_2_iter, label="BCJR(31,16) supercode(3,2)", alpha=1, linewidth=2)
plt.plot(esno_bch_31_16_supercode_3_matrix_2_iter, gaussian_filter1d(fer_bch_31_16_supercode_3_matrix_2_iter, sigma=0.6).tolist(), label="BCJR(31,16) supercode(3,2)", alpha=1, linewidth=2)

esno_bch_31_16_supercode_3_matrix_3_iter = [-4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2]
fer_bch_31_16_supercode_3_matrix_3_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9615384615384616, 0.9433962264150944, 0.9433962264150944, 0.9259259259259259, 0.8928571428571429, 0.9615384615384616, 0.8928571428571429, 0.819672131147541, 0.9090909090909091, 0.8928571428571429, 0.746268656716418, 0.7936507936507936, 0.7575757575757576, 0.7246376811594203, 0.7936507936507936, 0.819672131147541, 0.704225352112676, 0.684931506849315, 0.5102040816326531, 0.5154639175257731, 0.5, 0.45454545454545453, 0.4424778761061947, 0.3401360544217687, 0.31446540880503143, 0.3048780487804878, 0.2958579881656805, 0.23148148148148148, 0.1937984496124031, 0.1984126984126984, 0.14836795252225518, 0.10460251046025104, 0.1278772378516624, 0.06369426751592357, 0.06426735218508997, 0.05428881650380022, 0.02771618625277162, 0.028901734104046242, 0.018109380659181457, 0.016627868307283005, 0.008557247989046722, 0.007003782042302844, 0.006056201550387597, 0.0032139872726104006, 0.00214795085488444, 0.0012218366648746395, 0.000566931990838379, 0.00043240625432406255, 0.00023117966358735355, 0.00014830458201836605, 7.390076309927976e-05]
ber_bch_31_16_supercode_3_matrix_3_iter = [0.7154838709677419, 0.724516129032258, 0.7309677419354839, 0.7238709677419355, 0.7412903225806451, 0.4516129032258065, 0.2524813895781638, 0.2245891661594644, 0.24589166159464396, 0.23058542413381122, 0.23732718894009217, 0.23945409429280395, 0.24654377880184333, 0.19619249074563722, 0.2129032258064516, 0.2327188940092166, 0.16369764082811747, 0.17255504352278547, 0.16715542521994137, 0.16362786348761105, 0.1551459293394777, 0.17768376520359597, 0.129486597001363, 0.12991604065399912, 0.09940750493745885, 0.10442301296973727, 0.08774193548387096, 0.08181818181818182, 0.07108192977447902, 0.056396752249286815, 0.0490971799553662, 0.04799370574350905, 0.049436915441878226, 0.030465949820788533, 0.028132033008252063, 0.026753712237583206, 0.020771513353115726, 0.01376704008638143, 0.016252784423727414, 0.008300801314978427, 0.008085247532962933, 0.006374557808833316, 0.0029146699091624345, 0.0027410031698676114, 0.0020446074937785514, 0.0018129740283424696, 0.0008833288246757907, 0.0007365267567066861, 0.0004962178044511128, 0.00030273686567814094, 0.00018985114007688276, 0.00010011177834779304, 3.9502358071319315e-05, 3.71032463387744e-05, 1.909096576721371e-05, 1.2916850691922202e-05, 5.1015365494341515e-06]
# plt.plot(esno_bch_31_16_supercode_3_matrix_3_iter, fer_bch_31_16_supercode_3_matrix_3_iter, label="BCJR(31,16) supercode(3,3)", alpha=1, linewidth=2)
# plt.plot(esno_bch_31_16_supercode_3_matrix_3_iter, gaussian_filter1d(fer_bch_31_16_supercode_3_matrix_3_iter, sigma=0.6).tolist(), label="BCJR(31,16) supercode(3,3)", alpha=1, linewidth=2)

esno_bch_31_16_supercode_3_matrix_4_iter = [-4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0]
fer_bch_31_16_supercode_3_matrix_4_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 0.9803921568627451, 0.9433962264150944, 0.9803921568627451, 0.8620689655172413, 0.847457627118644, 0.9090909090909091, 0.8771929824561403, 0.8771929824561403, 0.7352941176470589, 0.8333333333333334, 0.746268656716418, 0.7936507936507936, 0.7352941176470589, 0.684931506849315, 0.6944444444444444, 0.5882352941176471, 0.5747126436781609, 0.5494505494505495, 0.4672897196261682, 0.46296296296296297, 0.43478260869565216, 0.44642857142857145, 0.30864197530864196, 0.3225806451612903, 0.2808988764044944, 0.2857142857142857, 0.23923444976076555, 0.18315018315018314, 0.19607843137254902, 0.12658227848101267, 0.10893246187363835, 0.0744047619047619, 0.09328358208955224, 0.07194244604316546, 0.0499001996007984, 0.028885037550548817, 0.029342723004694836, 0.018839487565938208, 0.013962580284836637, 0.015542430836182779, 0.007872775940796726, 0.004451566951566952, 0.00299311583358276, 0.0024792978628452424, 0.001261606782398062, 0.0006727935734757862, 0.00033778990818870297, 0.00019988726358333899, 0.00014402705404183123, 6.738117132257349e-05]
ber_bch_31_16_supercode_3_matrix_4_iter = [0.7387096774193549, 0.7580645161290324, 0.7548387096774194, 0.7470967741935484, 0.7348387096774194, 0.4117647058823529, 0.2605945604048071, 0.24528301886792453, 0.2530044275774826, 0.23804226918798665, 0.24166211044286495, 0.2498533724340176, 0.2393887945670628, 0.23599320882852293, 0.1864326375711575, 0.22258064516129034, 0.18006740491092924, 0.1848438300051203, 0.1774193548387097, 0.16703490941228458, 0.15053763440860213, 0.12144212523719165, 0.12754912866147572, 0.1162708259482453, 0.0892372625866747, 0.0967741935483871, 0.07713884992987377, 0.09158986175115207, 0.06252489048187973, 0.05577523413111342, 0.04784342152953969, 0.050875576036866356, 0.03735144312393888, 0.03249438733309701, 0.03213156230234029, 0.023356472029399757, 0.015461381685290604, 0.011760752688172043, 0.015105922002888784, 0.010025527964724994, 0.0075655141330242745, 0.00419298932185386, 0.0036725730728456763, 0.002625373751124292, 0.0019367450072515337, 0.0022260771907306946, 0.0011631391551241612, 0.0006260913518978035, 0.00039779474949551516, 0.0003774930939557917, 0.00016034615234349563, 8.290553066701622e-05, 4.7072658173393444e-05, 2.5276066878925446e-05, 1.9513342805667456e-05, 8.822202696883434e-06]
# plt.plot(esno_bch_31_16_supercode_3_matrix_4_iter, fer_bch_31_16_supercode_3_matrix_4_iter, label="BCJR(31,16) supercode(3,4)", alpha=1, linewidth=2)
# plt.plot(esno_bch_31_16_supercode_3_matrix_4_iter, gaussian_filter1d(fer_bch_31_16_supercode_3_matrix_4_iter, sigma=0.6).tolist(), label="BCJR(31,16) supercode(3,4)", alpha=1, linewidth=2)

esno_bch_31_16_supercode_3_matrix_5_iter = [-4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8]
fer_bch_31_16_supercode_3_matrix_5_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 0.9090909090909091, 0.9803921568627451, 0.9090909090909091, 0.7692307692307693, 0.847457627118644, 0.819672131147541, 0.9090909090909091, 0.7936507936507936, 0.8771929824561403, 0.7352941176470589, 0.7352941176470589, 0.746268656716418, 0.6666666666666666, 0.6097560975609756, 0.5319148936170213, 0.6756756756756757, 0.5882352941176471, 0.5208333333333334, 0.5952380952380952, 0.36231884057971014, 0.5434782608695652, 0.3333333333333333, 0.25510204081632654, 0.22026431718061673, 0.2631578947368421, 0.25510204081632654, 0.14925373134328357, 0.1592356687898089, 0.1519756838905775, 0.08620689655172414, 0.07656967840735068, 0.05820721769499418, 0.04428697962798937, 0.032916392363396975, 0.031725888324873094, 0.022999080036798528, 0.019083969465648856, 0.014128284826222097, 0.0075838010010617326, 0.008050233456770247, 0.00393360081818897, 0.0018038168765106967, 0.0011108395725489325, 0.0007998208401318105, 0.0006162492605008874, 0.0003853178486933872, 0.0001438902750318717, 0.0001011622417552773]
ber_bch_31_16_supercode_3_matrix_5_iter = [0.7412903225806451, 0.7548387096774194, 0.7393548387096774, 0.7406451612903225, 0.7380645161290323, 0.46516129032258063, 0.27640733712839977, 0.24809384164222872, 0.28842504743833014, 0.23401759530791788, 0.1990074441687345, 0.2498633132859486, 0.2316234796404019, 0.24222873900293254, 0.20327700972862264, 0.23655913978494625, 0.18785578747628082, 0.18500948766603414, 0.18006740491092924, 0.14666666666666667, 0.13493312352478362, 0.1252573781743308, 0.14777680906713164, 0.14079696394686905, 0.10719086021505377, 0.12788018433179724, 0.07784011220196353, 0.10694249649368863, 0.0675268817204301, 0.04970375246872943, 0.04149495523660651, 0.05178268251273344, 0.047893350888742595, 0.02676937891189215, 0.029278816519416478, 0.027159525443670948, 0.015239154616240265, 0.014276540038531838, 0.010289533966728003, 0.007371639189691134, 0.005394041071163117, 0.005424103487800884, 0.0036353384574294447, 0.003114996306328491, 0.0020053049430766847, 0.0012916925576001918, 0.0012620688580614, 0.0005633931494438396, 0.00027348191353549276, 0.00016196757638455402, 0.0001197151192971484, 7.911845344495263e-05, 5.8667749865573795e-05, 2.051596824647977e-05, 1.3959664184868015e-05]
# plt.plot(esno_bch_31_16_supercode_3_matrix_5_iter, fer_bch_31_16_supercode_3_matrix_5_iter, label="BCJR(31,16) supercode(3,5)", alpha=1, linewidth=2)
plt.plot(esno_bch_31_16_supercode_3_matrix_5_iter, gaussian_filter1d(fer_bch_31_16_supercode_3_matrix_5_iter, sigma=1).tolist(), label="BCJR(31,16) supercode(3,5)", alpha=1, linewidth=2)

plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("FER")
plt.title("BCH(31, 16)")
plt.legend()
plt.grid(True, which="both", linestyle="--")
plt.savefig('modeling_results/BCH(31,16)_BCJR+BCJR_supercode[(2,2)(3,2)(3,5)]_rovn.png', dpi=300, bbox_inches='tight')