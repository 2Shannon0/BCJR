import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d


esno_bch_15_7 = [-12, -11.6, -11.2, -10.8, -10.4, -10.0, -9.6, -9.2, -8.8, -8.4, -8.0, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0]
fer_bch_15_7 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9090909090909091, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9090909090909091, 1.0, 0.9090909090909091, 1.0, 0.9090909090909091, 0.6666666666666666, 0.7142857142857143, 0.8333333333333334, 0.5, 0.3448275862068966, 0.6666666666666666, 0.5263157894736842, 0.3125, 0.2777777777777778, 0.2564102564102564, 0.25, 0.10526315789473684, 0.18181818181818182, 0.10869565217391304, 0.04716981132075472, 0.059880239520958084, 0.078125, 0.013850415512465374, 0.022675736961451247, 0.007680491551459293, 0.004434589800443459]
ber_bch_15_7 = [0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.0606060606060606, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.0606060606060606, 0.06666666666666667, 0.0606060606060606, 0.06666666666666667, 0.0606060606060606, 0.04444444444444444, 0.047619047619047616, 0.05555555555555555, 0.03333333333333333, 0.022988505747126436, 0.04444444444444444, 0.03508771929824561, 0.020833333333333332, 0.018518518518518517, 0.017094017094017092, 0.016666666666666666, 0.007017543859649122, 0.012121212121212121, 0.007246376811594202, 0.003144654088050314, 0.003992015968063872, 0.005208333333333333, 0.0009233610341643582, 0.001511715797430083, 0.0005120327700972862, 0.00029563932002956393]

esno_bch_15_7_super = [-12, -11.6, -11.2, -10.8, -10.4, -10.0, -9.6, -9.2, -8.8, -8.4, -8.0, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0]
fer_bch_15_7_super = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8333333333333334, 1.0, 1.0, 1.0, 0.8333333333333334, 0.625, 1.0, 1.0, 0.625, 0.19230769230769232, 0.09433962264150944, 0.010101010101010102, 0.000612369871402327]
ber_bch_15_7_super = [0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.05555555555555555, 0.06666666666666667, 0.06666666666666667, 0.06666666666666667, 0.05555555555555555, 0.041666666666666664, 0.06666666666666667, 0.06666666666666667, 0.041666666666666664, 0.01282051282051282, 0.006289308176100628, 0.0006734006734006733, 4.0824658093488464e-05]


# plt.plot(esno_bch_15_7, fer_bch_15_7, label="BCH orig", alpha=0.5, linewidth=1)
plt.plot(esno_bch_15_7, gaussian_filter1d(fer_bch_15_7, sigma=0.85).tolist(), label="BCH classic", linewidth=2)

# plt.plot(esno_bch_15_7_super, fer_bch_15_7_super, label="BCH super orig ", alpha=0.5, linewidth=1)
plt.plot(esno_bch_15_7_super, gaussian_filter1d(fer_bch_15_7_super, sigma=0.85).tolist(), label="BCH supercode", linewidth=2)

plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo")
plt.ylabel("FER")
plt.title("BCJR BCH(15, 7)")
plt.legend()
plt.grid(True, which="both", linestyle="--")
plt.show()