import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d
#-----------------------BCH(31,21) original----------------------------------------------------------------
esno_bch_31_21 = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6,]
fer_bch_31_21 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 1.0, 1.0, 0.967741935483871, 0.96, 0.9302325581395349, 0.967741935483871, 0.8888888888888888, 0.821917808219178, 0.7843137254901961, 0.759493670886076, 0.6703910614525139, 0.5429864253393665, 0.46511627906976744, 0.40540540540540543, 0.3418803418803419, 0.32432432432432434, 0.24048096192384769, 0.20761245674740483, 0.1362088535754824, 0.09724473257698542, 0.08836524300441827, 0.07439553626782393, 0.056100981767180924, 0.048484848484848485, 0.03293084522502744, 0.02306805074971165, 0.013211493999779809, 0.009936242444315641, 0.006948465547191662, 0.004155268534229025, 0.0028578913524970827, 0.0019907100199071004, 0.001316049220240837, 0.0006781116849945186, 0.0003866789114988641, 0.00019648470991711917, ]
ber_bch_31_21 = [0.33252688172043016, 0.33413978494623653, 0.3198924731182796, 0.3255376344086021, 0.3086021505376344, 0.3086021505376344, 0.2940860215053763, 0.3126344086021505, 0.2986559139784946, 0.2932795698924731, 0.28440860215053765, 0.28978494623655915, 0.27741935483870966, 0.27177419354838706, 0.2685483870967742, 0.2599462365591398, 0.24408602150537634, 0.26048387096774195, 0.2510752688172043, 0.25564516129032255, 0.24704301075268817, 0.23978494623655913, 0.2336021505376344, 0.2217741935483871, 0.21478494623655914, 0.21263440860215052, 0.2110215053763441, 0.214247311827957, 0.1956989247311828, 0.1814516129032258, 0.1674220207944548, 0.16662223407091442, 0.18075179952012796, 0.16586021505376344, 0.16263440860215053, 0.15634755463059313, 0.14735483870967742, 0.13378344586146537, 0.13605619146722164, 0.12879330943847073, 0.10737958462218294, 0.10963525195024246, 0.10677827684769294, 0.08650207244548568, 0.07312801050941468, 0.061640410102525627, 0.05405405405405406, 0.04438930245381858, 0.047079337401918046, 0.03684788932704118, 0.0317557763143208, 0.021786093515433345, 0.014795838343702619, 0.014751294598318209, 0.012159270443773374, 0.009018383628165105, 0.008563049853372435, 0.005692078892390496, 0.00410512085922288, 0.002319114403724789, 0.001768223789821762, 0.0012477352111623736, 0.0007271719934900792, 0.0005070452399591598, 0.00034623370507524026, 0.00022960106019793096, 0.00011794039252458429, 6.850037706391168e-05, 3.3189206132627755e-05,]
plt.plot(esno_bch_31_21, fer_bch_31_21, label="BCJR(31,21)", linewidth=2)
# plt.plot(esno_bch_31_21, ber_bch_31_21, label="BCJR(31,21)", linewidth=2)


#-----------------------BCH(31,21) supercode----------------------------------------------------------------
esno_bch_31_21_supercode_2_matrix_1_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6,]
fer_bch_31_21_supercode_2_matrix_1_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.975609756097561, 0.967741935483871, 0.9836065573770492, 0.9836065573770492, 0.96, 0.9523809523809523, 0.8888888888888888, 0.8759124087591241, 0.8955223880597015, 0.8, 0.7792207792207793, 0.7643312101910829, 0.75, 0.7017543859649122, 0.6779661016949152, 0.5309734513274337, 0.5286343612334802, 0.5063291139240507, 0.45112781954887216, 0.3870967741935484, 0.33240997229916897, 0.2977667493796526, 0.23255813953488372, 0.2185792349726776, 0.19639934533551553, 0.192, 0.1343784994400896, 0.10752688172043011, 0.09036144578313253, 0.065323897659227, 0.05946481665014866, 0.044626255113425065, 0.03560830860534125, 0.021197668256491786, 0.016183412002697236, 0.012918505759500484, 0.009155413138017853, 0.006532034184312231, 0.004884800130261337, 0.0032344141667340503, 0.0026467863602276237, 0.0018270401948842874, 0.001219884111009454, 0.0007881411035289018,]
ber_bch_31_21_supercode_2_matrix_1_iter = [0.6666666666666666, 0.6717741935483871, 0.6900537634408602, 0.6706989247311828, 0.6889784946236559, 0.7, 0.693010752688172, 0.707258064516129, 0.703763440860215, 0.7040322580645161, 0.7126344086021505, 0.7196236559139785, 0.7126344086021505, 0.7295698924731183, 0.7182795698924731, 0.7365591397849462, 0.7454301075268818, 0.7330645161290322, 0.7440860215053764, 0.7634408602150538, 0.7591397849462366, 0.7591397849462366, 0.7669354838709678, 0.771505376344086, 0.7774193548387097, 0.7908602150537635, 0.7943548387096775, 0.789516129032258, 0.7978494623655913, 0.8048387096774193, 0.8040322580645162, 0.8169354838709677, 0.831989247311828, 0.831989247311828, 0.8422043010752688, 0.20744820351429322, 0.14698231009365245, 0.1404019037546272, 0.14436805922792173, 0.1272258064516129, 0.12314388120839734, 0.11445639187574672, 0.10736990817047327, 0.09918151179585942, 0.09913978494623656, 0.09049015500628405, 0.09245942058763099, 0.08084677419354838, 0.07696661007357103, 0.06506287588846364, 0.05081358835284042, 0.05186869404575813, 0.04450796243364639, 0.04098957070094591, 0.03246618106139438, 0.027879546063801268, 0.026014568158168577, 0.01825456364091023, 0.01621716904635995, 0.015521883744258488, 0.0144, 0.007622006285445942, 0.0066770724939299335, 0.005878352118150019, 0.004091523697473089, 0.0036606029604527, 0.0026271908252258305, 0.00178998755623624, 0.0009972021357220599, 0.0007482652861462163, 0.0005938345389447804, 0.00040362574049326015, 0.0002791917836843131, 0.00021666452190675283, 0.00012520312903486648, 0.00010530225304131406, 6.532159836548662e-05, 4.295828455436518e-05, 2.6906967781766272e-05,]
plt.plot(esno_bch_31_21_supercode_2_matrix_1_iter, fer_bch_31_21_supercode_2_matrix_1_iter, label="BCJR(31,21) supercode(2,1)", linewidth=2)
# plt.plot(esno_bch_31_21_supercode_2_matrix_1_iter, ber_bch_31_21_supercode_2_matrix_1_iter, label="BCJR(31,21) supercode(2,1)", linewidth=2)


esno_bch_31_21_supercode_2_matrix_2_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0,]
fer_bch_31_21_supercode_2_matrix_2_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9836065573770492, 0.96, 0.9448818897637795, 0.9022556390977443, 0.8633093525179856, 0.9230769230769231, 0.7894736842105263, 0.7741935483870968, 0.7317073170731707, 0.6349206349206349, 0.5741626794258373, 0.4897959183673469, 0.4897959183673469, 0.4316546762589928, 0.375, 0.3133159268929504, 0.2857142857142857, 0.2597402597402597, 0.19138755980861244, 0.21897810218978103, 0.17543859649122806, 0.12486992715920915, 0.11417697431018078, 0.08333333333333333, 0.05862237420615535, 0.04631416441528367, 0.03428571428571429, 0.023464998044583497, 0.01882648258550361, 0.015170670037926675, 0.008913980092111128, 0.0054456344164095115, 0.0036711842628567933, 0.0023938716884774978, 0.0015356658391134088,]
ber_bch_31_21_supercode_2_matrix_2_iter = [0.6704301075268817, 0.6803763440860214, 0.6879032258064516, 0.6728494623655913, 0.6766129032258064, 0.6956989247311828, 0.6911290322580645, 0.7026881720430108, 0.7045698924731183, 0.7043010752688172, 0.7131720430107527, 0.7032258064516129, 0.728225806451613, 0.7338709677419355, 0.739516129032258, 0.746505376344086, 0.743010752688172, 0.731720430107527, 0.7545698924731182, 0.7733870967741936, 0.7551075268817204, 0.7650537634408603, 0.7639784946236559, 0.7758064516129032, 0.7776881720430108, 0.7879032258064516, 0.785752688172043, 0.7959677419354839, 0.8255376344086022, 0.7991935483870968, 0.8241935483870968, 0.8067204301075269, 0.8166666666666667, 0.8341397849462365, 0.8475806451612903, 0.20927752599306854, 0.15943945002644105, 0.14606451612903226, 0.14884429768859536, 0.134125636672326, 0.12694360640519842, 0.1347394540942928, 0.1118421052631579, 0.1105098855359001, 0.11191974822974037, 0.08943505717699266, 0.08380922981941658, 0.07044107965766952, 0.07109940750493746, 0.05732188442794152, 0.050302419354838715, 0.04354417586119767, 0.038632872503840246, 0.03260717776846809, 0.025106755157688943, 0.027784318342359313, 0.02188266364836823, 0.013191903595045483, 0.01464043460912802, 0.009296594982078852, 0.006082859259025797, 0.004818167104493221, 0.0035483870967741938, 0.0021635737444333706, 0.0018826482585503608, 0.0013172382855511603, 0.0008051336857390696, 0.0004977192746180736, 0.0003276433266850686, 0.00018018389053056435, 0.00011352368434306115,]
plt.plot(esno_bch_31_21_supercode_2_matrix_2_iter, fer_bch_31_21_supercode_2_matrix_2_iter, label="BCJR(31,21) supercode(2,2)", linewidth=2)
# plt.plot(esno_bch_31_21_supercode_2_matrix_2_iter, ber_bch_31_21_supercode_2_matrix_2_iter, label="BCJR(31,21) supercode(2,2)", linewidth=2)


esno_bch_31_21_supercode_2_matrix_3_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6,]
fer_bch_31_21_supercode_2_matrix_3_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.975609756097561, 0.96, 0.9302325581395349, 0.8888888888888888, 0.9375, 0.821917808219178, 0.8, 0.7272727272727273, 0.6349206349206349, 0.6185567010309279, 0.6091370558375635, 0.5042016806722689, 0.45627376425855515, 0.44280442804428044, 0.32697547683923706, 0.3468208092485549, 0.3022670025188917, 0.22727272727272727, 0.20689655172413793, 0.1724137931034483, 0.13872832369942195, 0.12207527975584945, 0.11594202898550725, 0.06289308176100629, 0.060453400503778336, 0.046948356807511735, 0.03051106025934401, 0.026554547466253596, 0.017436791630340016, 0.010643959552953698, 0.008696282339299949, 0.005346878759524128, 0.003554081269991707, 0.0024694914905439057, ]
ber_bch_31_21_supercode_2_matrix_3_iter = [0.6776881720430108, 0.6889784946236559, 0.6787634408602151, 0.6841397849462365, 0.6841397849462365, 0.6849462365591398, 0.6975806451612903, 0.6860215053763441, 0.6978494623655913, 0.7091397849462365, 0.7225806451612903, 0.7260752688172043, 0.7220430107526882, 0.7266129032258064, 0.7306451612903225, 0.739516129032258, 0.7540322580645161, 0.7443548387096774, 0.7537634408602151, 0.7591397849462366, 0.7647849462365592, 0.7731182795698925, 0.7634408602150538, 0.7811827956989247, 0.7838709677419354, 0.7838709677419354, 0.796236559139785, 0.7981182795698926, 0.8048387096774193, 0.8155913978494624, 0.8077956989247312, 0.814247311827957, 0.8188172043010753, 0.8362903225806452, 0.8352150537634409, 0.19223708366115919, 0.1406451612903226, 0.14453613403350837, 0.13572281959378735, 0.13482862903225806, 0.1254971277065842, 0.11784946236559139, 0.11612903225806451, 0.10087045570916539, 0.10375789823744595, 0.10528901260848207, 0.0867443751694226, 0.08070648840917453, 0.07094393524580407, 0.0542322229058627, 0.053794517993660265, 0.04436499553099862, 0.03457966764418377, 0.03081201334816463, 0.02340563589173155, 0.018124184225247062, 0.01522659403406294, 0.015645940470624904, 0.007455873402312843, 0.007052896725440806, 0.00576758039275077, 0.0033053648614289346, 0.003169413729843171, 0.0019780446419364215, 0.0012561016784265252, 0.0008743036545425217, 0.0005864318639478076, 0.0003754714890071884, 0.0002462853072558572,]
plt.plot(esno_bch_31_21_supercode_2_matrix_3_iter, fer_bch_31_21_supercode_2_matrix_3_iter, label="BCJR(31,21) supercode(2,3)", linewidth=2)
# plt.plot(esno_bch_31_21_supercode_2_matrix_3_iter, ber_bch_31_21_supercode_2_matrix_3_iter, label="BCJR(31,21) supercode(2,3)", linewidth=2)


esno_bch_31_21_supercode_3_matrix_1_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8,]
fer_bch_31_21_supercode_3_matrix_1_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.967741935483871, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 0.975609756097561, 0.96, 0.975609756097561, 0.96, 0.8888888888888888, 0.8888888888888888, 0.8333333333333334, 0.8163265306122449, 0.7792207792207793, 0.718562874251497, 0.6349206349206349, 0.7058823529411765, 0.594059405940594, 0.5309734513274337, 0.5, 0.47244094488188976, 0.4195804195804196, 0.4013377926421405, 0.3761755485893417, 0.32608695652173914, 0.27149321266968324, 0.22727272727272727, 0.22058823529411764, 0.1744186046511628, 0.13498312710911137, 0.12012012012012012, 0.10899182561307902, 0.07177033492822966, 0.06329113924050633, 0.04803843074459568, 0.04713275726630008, 0.03575685339690107, 0.023469587326422844, 0.01927710843373494, 0.016266775111834077, 0.009387467730579677, 0.006155740227762389, 0.005043500189131257, 0.003240090722540231, 0.002913894419892186, 0.0019205531192983578, 0.0012381217692760084, 0.0009146690041541217, 0.0005430601439109381, 0.0004085662728541759,]
ber_bch_31_21_supercode_3_matrix_1_iter = [0.6736559139784947, 0.6776881720430108, 0.6768817204301075, 0.6774193548387097, 0.6868279569892474, 0.696505376344086, 0.6922043010752688, 0.7123655913978495, 0.7008064516129032, 0.7080645161290323, 0.707258064516129, 0.7131720430107527, 0.7370967741935484, 0.725268817204301, 0.7379032258064516, 0.7239247311827958, 0.7432795698924731, 0.7400537634408603, 0.7462365591397849, 0.7456989247311828, 0.7486559139784946, 0.7685483870967741, 0.7674731182795699, 0.7706989247311828, 0.7728494623655914, 0.7803763440860215, 0.7981182795698926, 0.7967741935483871, 0.8029569892473118, 0.814247311827957, 0.8150537634408602, 0.8244623655913978, 0.8268817204301074, 0.8279569892473119, 0.8344086021505376, 0.17299687825182103, 0.16693548387096774, 0.1474273527059451, 0.13836310317248735, 0.13516395627832578, 0.13139260424862312, 0.1272258064516129, 0.12431156569630213, 0.12283870967741936, 0.0998805256869773, 0.1010752688172043, 0.08848566308243727, 0.08624094799210007, 0.07436112274821952, 0.06451612903225806, 0.060249189281447346, 0.06432637571157496, 0.051900351325455125, 0.04381958321438766, 0.04099462365591398, 0.0381000762001524, 0.030453417550191743, 0.027834717876793612, 0.02265143088279907, 0.02200210378681627, 0.01722376295431324, 0.013318670576735093, 0.011918880455407968, 0.010502625656414103, 0.006966871076599296, 0.006264328844974006, 0.005039406990712256, 0.0032991202346041057, 0.0027732407785490674, 0.002104909734239004, 0.0019258545979778526, 0.0013649121457956863, 0.0010094446161902299, 0.000725482575463143, 0.0005859537271467114, 0.0003406742321581334, 0.00022504856746658193, 0.00017896290993691557, 0.00012019691390068598, 9.869642389957404e-05, 6.763238135163571e-05, 4.260203937293792e-05, 2.9751330511464714e-05, 1.7664053068070838e-05, 1.3399216475325123e-05,]
plt.plot(esno_bch_31_21_supercode_3_matrix_1_iter, fer_bch_31_21_supercode_3_matrix_1_iter, label="BCJR(31,21) supercode(3,1)", linewidth=2)

esno_bch_31_21_supercode_3_matrix_2_iter = []
fer_bch_31_21_supercode_3_matrix_2_iter = []
ber_bch_31_21_supercode_3_matrix_2_iter = []
# plt.plot(esno_bch_31_21_supercode_3_matrix_2_iter, fer_bch_31_21_supercode_3_matrix_2_iter, label="BCJR(31,21) supercode(3,2)", linewidth=2)

esno_bch_31_21_supercode_3_matrix_3_iter = []
fer_bch_31_21_supercode_3_matrix_3_iter = []
ber_bch_31_21_supercode_3_matrix_3_iter = []
# plt.plot(esno_bch_31_21_supercode_3_matrix_3_iter, fer_bch_31_21_supercode_3_matrix_3_iter, label="BCJR(31,21) supercode(3,3)", linewidth=2)


esno_bch_31_21_supercode_3_matrix_4_iter = []
fer_bch_31_21_supercode_3_matrix_4_iter = []
ber_bch_31_21_supercode_3_matrix_4_iter = []
# plt.plot(esno_bch_31_21_supercode_3_matrix_4_iter, fer_bch_31_21_supercode_3_matrix_4_iter, label="BCJR(31,21) supercode(3,4)", linewidth=2)


esno_bch_31_21_supercode_3_matrix_5_iter = []
fer_bch_31_21_supercode_3_matrix_5_iter = []
ber_bch_31_21_supercode_3_matrix_5_iter = []
# plt.plot(esno_bch_31_21_supercode_3_matrix_5_iter, fer_bch_31_21_supercode_3_matrix_5_iter, label="BCJR(31,21) supercode(3,5)", linewidth=2)


plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("FER")
plt.title("BCH(31, 21)")
plt.legend()
plt.grid(True, which="both", linestyle="--")
plt.savefig('modeling_results/BCH(31,21)_complex_awgn_FER.png', dpi=300, bbox_inches='tight')