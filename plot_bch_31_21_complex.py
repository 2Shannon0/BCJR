import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d
#-----------------------BCH(31,21) original----------------------------------------------------------------
esno_bch_31_21 = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, ]
fer_bch_31_21 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 1.0, 1.0, 0.967741935483871, 0.96, 0.9302325581395349, 0.967741935483871, 0.8888888888888888, 0.821917808219178, 0.7843137254901961, 0.759493670886076, 0.6703910614525139, 0.5429864253393665, 0.46511627906976744, 0.40540540540540543, 0.3418803418803419, 0.32432432432432434, 0.24048096192384769, 0.20761245674740483, 0.1362088535754824, 0.09724473257698542, 0.08836524300441827, 0.07439553626782393, 0.056100981767180924, 0.048484848484848485, 0.03293084522502744, 0.02306805074971165, 0.013211493999779809, 0.009936242444315641, 0.006948465547191662, 0.004155268534229025, 0.0028578913524970827, 0.0019907100199071004, 0.001316049220240837, 0.0006781116849945186, 0.0003866789114988641, 0.00022117817929809104, 0.00011824267732952855, 8.012023376413538e-05, ]
ber_bch_31_21 = [0.33252688172043016, 0.33413978494623653, 0.3198924731182796, 0.3255376344086021, 0.3086021505376344, 0.3086021505376344, 0.2940860215053763, 0.3126344086021505, 0.2986559139784946, 0.2932795698924731, 0.28440860215053765, 0.28978494623655915, 0.27741935483870966, 0.27177419354838706, 0.2685483870967742, 0.2599462365591398, 0.24408602150537634, 0.26048387096774195, 0.2510752688172043, 0.25564516129032255, 0.24704301075268817, 0.23978494623655913, 0.2336021505376344, 0.2217741935483871, 0.21478494623655914, 0.21263440860215052, 0.2110215053763441, 0.214247311827957, 0.1956989247311828, 0.1814516129032258, 0.1674220207944548, 0.16662223407091442, 0.18075179952012796, 0.16586021505376344, 0.16263440860215053, 0.15634755463059313, 0.14735483870967742, 0.13378344586146537, 0.13605619146722164, 0.12879330943847073, 0.10737958462218294, 0.10963525195024246, 0.10677827684769294, 0.08650207244548568, 0.07312801050941468, 0.061640410102525627, 0.05405405405405406, 0.04438930245381858, 0.047079337401918046, 0.03684788932704118, 0.0317557763143208, 0.021786093515433345, 0.014795838343702619, 0.014751294598318209, 0.012159270443773374, 0.009018383628165105, 0.008563049853372435, 0.005692078892390496, 0.00410512085922288, 0.002319114403724789, 0.001768223789821762, 0.0012477352111623736, 0.0007271719934900792, 0.0005070452399591598, 0.00034623370507524026, 0.00022960106019793096, 0.00011794039252458429, 6.850037706391168e-05, 3.852781187773199e-05, 2.0597111534821102e-05, 1.376258854174261e-05,]
# plt.plot(esno_bch_31_21, fer_bch_31_21, label="BCJR(31,21)", linewidth=2)
plt.plot(esno_bch_31_21, ber_bch_31_21, label="BCJR(31,21)", linewidth=2)


#-----------------------BCH(31,21) supercode----------------------------------------------------------------
esno_bch_31_21_supercode_2_matrix_1_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4,]
fer_bch_31_21_supercode_2_matrix_1_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.975609756097561, 0.967741935483871, 0.9836065573770492, 0.9836065573770492, 0.96, 0.9523809523809523, 0.8888888888888888, 0.8759124087591241, 0.8955223880597015, 0.8, 0.7792207792207793, 0.7643312101910829, 0.75, 0.7017543859649122, 0.6779661016949152, 0.5309734513274337, 0.5286343612334802, 0.5063291139240507, 0.45112781954887216, 0.3870967741935484, 0.33240997229916897, 0.2977667493796526, 0.23255813953488372, 0.2185792349726776, 0.19639934533551553, 0.192, 0.1343784994400896, 0.10752688172043011, 0.09036144578313253, 0.065323897659227, 0.05946481665014866, 0.044626255113425065, 0.03560830860534125, 0.021197668256491786, 0.016183412002697236, 0.012918505759500484, 0.009155413138017853, 0.006532034184312231, 0.004884800130261337, 0.0032344141667340503, 0.0026467863602276237, 0.0018270401948842874, 0.001219884111009454, 0.0007881411035289018, 0.0005001396223112285, 0.00036158409994184524, 0.00018627205965673164, 0.0001433549970427677,]
ber_bch_31_21_supercode_2_matrix_1_iter = [0.6666666666666666, 0.6717741935483871, 0.6900537634408602, 0.6706989247311828, 0.6889784946236559, 0.7, 0.693010752688172, 0.707258064516129, 0.703763440860215, 0.7040322580645161, 0.7126344086021505, 0.7196236559139785, 0.7126344086021505, 0.7295698924731183, 0.7182795698924731, 0.7365591397849462, 0.7454301075268818, 0.7330645161290322, 0.7440860215053764, 0.7634408602150538, 0.7591397849462366, 0.7591397849462366, 0.7669354838709678, 0.771505376344086, 0.7774193548387097, 0.7908602150537635, 0.7943548387096775, 0.789516129032258, 0.7978494623655913, 0.8048387096774193, 0.8040322580645162, 0.8169354838709677, 0.831989247311828, 0.831989247311828, 0.8422043010752688, 0.20744820351429322, 0.14698231009365245, 0.1404019037546272, 0.14436805922792173, 0.1272258064516129, 0.12314388120839734, 0.11445639187574672, 0.10736990817047327, 0.09918151179585942, 0.09913978494623656, 0.09049015500628405, 0.09245942058763099, 0.08084677419354838, 0.07696661007357103, 0.06506287588846364, 0.05081358835284042, 0.05186869404575813, 0.04450796243364639, 0.04098957070094591, 0.03246618106139438, 0.027879546063801268, 0.026014568158168577, 0.01825456364091023, 0.01621716904635995, 0.015521883744258488, 0.0144, 0.007622006285445942, 0.0066770724939299335, 0.005878352118150019, 0.004091523697473089, 0.0036606029604527, 0.0026271908252258305, 0.00178998755623624, 0.0009972021357220599, 0.0007482652861462163, 0.0005938345389447804, 0.00040362574049326015, 0.0002791917836843131, 0.00021666452190675283, 0.00012520312903486648, 0.00010530225304131406, 6.532159836548662e-05, 4.295828455436518e-05, 2.6906967781766272e-05, 1.7477997553887017e-05, 1.2052803331394841e-05, 6.108922386591737e-06, 5.8113945877714665e-06,]
# plt.plot(esno_bch_31_21_supercode_2_matrix_1_iter, fer_bch_31_21_supercode_2_matrix_1_iter, label="BCJR(31,21) supercode(2,1)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_2_matrix_1_iter, ber_bch_31_21_supercode_2_matrix_1_iter, label="BCJR(31,21) supercode(2,1)", linewidth=2)


esno_bch_31_21_supercode_2_matrix_2_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6,]
fer_bch_31_21_supercode_2_matrix_2_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9836065573770492, 0.96, 0.9448818897637795, 0.9022556390977443, 0.8633093525179856, 0.9230769230769231, 0.7894736842105263, 0.7741935483870968, 0.7317073170731707, 0.6349206349206349, 0.5741626794258373, 0.4897959183673469, 0.4897959183673469, 0.4316546762589928, 0.375, 0.3133159268929504, 0.2857142857142857, 0.2597402597402597, 0.19138755980861244, 0.21897810218978103, 0.17543859649122806, 0.12486992715920915, 0.11417697431018078, 0.08333333333333333, 0.05862237420615535, 0.04631416441528367, 0.03428571428571429, 0.023464998044583497, 0.01882648258550361, 0.015170670037926675, 0.008913980092111128, 0.0054456344164095115, 0.0036711842628567933, 0.0023938716884774978, 0.0015356658391134088, 0.0009758398321555488, 0.0005846756511825065, 0.0003776233018752144,]
ber_bch_31_21_supercode_2_matrix_2_iter = [0.6704301075268817, 0.6803763440860214, 0.6879032258064516, 0.6728494623655913, 0.6766129032258064, 0.6956989247311828, 0.6911290322580645, 0.7026881720430108, 0.7045698924731183, 0.7043010752688172, 0.7131720430107527, 0.7032258064516129, 0.728225806451613, 0.7338709677419355, 0.739516129032258, 0.746505376344086, 0.743010752688172, 0.731720430107527, 0.7545698924731182, 0.7733870967741936, 0.7551075268817204, 0.7650537634408603, 0.7639784946236559, 0.7758064516129032, 0.7776881720430108, 0.7879032258064516, 0.785752688172043, 0.7959677419354839, 0.8255376344086022, 0.7991935483870968, 0.8241935483870968, 0.8067204301075269, 0.8166666666666667, 0.8341397849462365, 0.8475806451612903, 0.20927752599306854, 0.15943945002644105, 0.14606451612903226, 0.14884429768859536, 0.134125636672326, 0.12694360640519842, 0.1347394540942928, 0.1118421052631579, 0.1105098855359001, 0.11191974822974037, 0.08943505717699266, 0.08380922981941658, 0.07044107965766952, 0.07109940750493746, 0.05732188442794152, 0.050302419354838715, 0.04354417586119767, 0.038632872503840246, 0.03260717776846809, 0.025106755157688943, 0.027784318342359313, 0.02188266364836823, 0.013191903595045483, 0.01464043460912802, 0.009296594982078852, 0.006082859259025797, 0.004818167104493221, 0.0035483870967741938, 0.0021635737444333706, 0.0018826482585503608, 0.0013172382855511603, 0.0008051336857390696, 0.0004977192746180736, 0.0003276433266850686, 0.00018018389053056435, 0.00011352368434306115, 7.554889023139734e-05, 3.803535150165768e-05, 2.3956747108212527e-05,]
# plt.plot(esno_bch_31_21_supercode_2_matrix_2_iter, fer_bch_31_21_supercode_2_matrix_2_iter, label="BCJR(31,21) supercode(2,2)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_2_matrix_2_iter, ber_bch_31_21_supercode_2_matrix_2_iter, label="BCJR(31,21) supercode(2,2)", linewidth=2)


esno_bch_31_21_supercode_2_matrix_3_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0,]
fer_bch_31_21_supercode_2_matrix_3_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.975609756097561, 0.96, 0.9302325581395349, 0.8888888888888888, 0.9375, 0.821917808219178, 0.8, 0.7272727272727273, 0.6349206349206349, 0.6185567010309279, 0.6091370558375635, 0.5042016806722689, 0.45627376425855515, 0.44280442804428044, 0.32697547683923706, 0.3468208092485549, 0.3022670025188917, 0.22727272727272727, 0.20689655172413793, 0.1724137931034483, 0.13872832369942195, 0.12207527975584945, 0.11594202898550725, 0.06289308176100629, 0.060453400503778336, 0.046948356807511735, 0.03051106025934401, 0.026554547466253596, 0.017436791630340016, 0.010643959552953698, 0.008696282339299949, 0.005346878759524128, 0.003554081269991707, 0.0024694914905439057, 0.0014078723529066697, 0.0007721361790841179, ]
ber_bch_31_21_supercode_2_matrix_3_iter = [0.6776881720430108, 0.6889784946236559, 0.6787634408602151, 0.6841397849462365, 0.6841397849462365, 0.6849462365591398, 0.6975806451612903, 0.6860215053763441, 0.6978494623655913, 0.7091397849462365, 0.7225806451612903, 0.7260752688172043, 0.7220430107526882, 0.7266129032258064, 0.7306451612903225, 0.739516129032258, 0.7540322580645161, 0.7443548387096774, 0.7537634408602151, 0.7591397849462366, 0.7647849462365592, 0.7731182795698925, 0.7634408602150538, 0.7811827956989247, 0.7838709677419354, 0.7838709677419354, 0.796236559139785, 0.7981182795698926, 0.8048387096774193, 0.8155913978494624, 0.8077956989247312, 0.814247311827957, 0.8188172043010753, 0.8362903225806452, 0.8352150537634409, 0.19223708366115919, 0.1406451612903226, 0.14453613403350837, 0.13572281959378735, 0.13482862903225806, 0.1254971277065842, 0.11784946236559139, 0.11612903225806451, 0.10087045570916539, 0.10375789823744595, 0.10528901260848207, 0.0867443751694226, 0.08070648840917453, 0.07094393524580407, 0.0542322229058627, 0.053794517993660265, 0.04436499553099862, 0.03457966764418377, 0.03081201334816463, 0.02340563589173155, 0.018124184225247062, 0.01522659403406294, 0.015645940470624904, 0.007455873402312843, 0.007052896725440806, 0.00576758039275077, 0.0033053648614289346, 0.003169413729843171, 0.0019780446419364215, 0.0012561016784265252, 0.0008743036545425217, 0.0005864318639478076, 0.0003754714890071884, 0.0002462853072558572, 0.00014608567962956303, 7.077914974937747e-05,]
# plt.plot(esno_bch_31_21_supercode_2_matrix_3_iter, fer_bch_31_21_supercode_2_matrix_3_iter, label="BCJR(31,21) supercode(2,3)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_2_matrix_3_iter, ber_bch_31_21_supercode_2_matrix_3_iter, label="BCJR(31,21) supercode(2,3)", linewidth=2)


esno_bch_31_21_supercode_3_matrix_1_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4, 5.6, 5.8, 6.0, 6.2, 6.4, 6.6, 6.8, 7.0, 7.2,]
fer_bch_31_21_supercode_3_matrix_1_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.967741935483871, 1.0, 0.9917355371900827, 0.9917355371900827, 0.9917355371900827, 0.975609756097561, 0.96, 0.975609756097561, 0.96, 0.8888888888888888, 0.8888888888888888, 0.8333333333333334, 0.8163265306122449, 0.7792207792207793, 0.718562874251497, 0.6349206349206349, 0.7058823529411765, 0.594059405940594, 0.5309734513274337, 0.5, 0.47244094488188976, 0.4195804195804196, 0.4013377926421405, 0.3761755485893417, 0.32608695652173914, 0.27149321266968324, 0.22727272727272727, 0.22058823529411764, 0.1744186046511628, 0.13498312710911137, 0.12012012012012012, 0.10899182561307902, 0.07177033492822966, 0.06329113924050633, 0.04803843074459568, 0.04713275726630008, 0.03575685339690107, 0.023469587326422844, 0.01927710843373494, 0.016266775111834077, 0.009387467730579677, 0.006155740227762389, 0.005043500189131257, 0.003240090722540231, 0.002913894419892186, 0.0019205531192983578, 0.0012381217692760084, 0.0009146690041541217, 0.0005430601439109381, 0.0004085662728541759, 0.00023809193126285945, 0.0001377691952671689,]
ber_bch_31_21_supercode_3_matrix_1_iter = [0.6736559139784947, 0.6776881720430108, 0.6768817204301075, 0.6774193548387097, 0.6868279569892474, 0.696505376344086, 0.6922043010752688, 0.7123655913978495, 0.7008064516129032, 0.7080645161290323, 0.707258064516129, 0.7131720430107527, 0.7370967741935484, 0.725268817204301, 0.7379032258064516, 0.7239247311827958, 0.7432795698924731, 0.7400537634408603, 0.7462365591397849, 0.7456989247311828, 0.7486559139784946, 0.7685483870967741, 0.7674731182795699, 0.7706989247311828, 0.7728494623655914, 0.7803763440860215, 0.7981182795698926, 0.7967741935483871, 0.8029569892473118, 0.814247311827957, 0.8150537634408602, 0.8244623655913978, 0.8268817204301074, 0.8279569892473119, 0.8344086021505376, 0.17299687825182103, 0.16693548387096774, 0.1474273527059451, 0.13836310317248735, 0.13516395627832578, 0.13139260424862312, 0.1272258064516129, 0.12431156569630213, 0.12283870967741936, 0.0998805256869773, 0.1010752688172043, 0.08848566308243727, 0.08624094799210007, 0.07436112274821952, 0.06451612903225806, 0.060249189281447346, 0.06432637571157496, 0.051900351325455125, 0.04381958321438766, 0.04099462365591398, 0.0381000762001524, 0.030453417550191743, 0.027834717876793612, 0.02265143088279907, 0.02200210378681627, 0.01722376295431324, 0.013318670576735093, 0.011918880455407968, 0.010502625656414103, 0.006966871076599296, 0.006264328844974006, 0.005039406990712256, 0.0032991202346041057, 0.0027732407785490674, 0.002104909734239004, 0.0019258545979778526, 0.0013649121457956863, 0.0010094446161902299, 0.000725482575463143, 0.0005859537271467114, 0.0003406742321581334, 0.00022504856746658193, 0.00017896290993691557, 0.00012019691390068598, 9.869642389957404e-05, 6.763238135163571e-05, 4.260203937293792e-05, 2.9751330511464714e-05, 1.7664053068070838e-05, 1.3399216475325123e-05, 7.80839129410453e-06, 4.518237049084572e-06,]
# plt.plot(esno_bch_31_21_supercode_3_matrix_1_iter, fer_bch_31_21_supercode_3_matrix_1_iter, label="BCJR(31,21) supercode(3,1)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_3_matrix_1_iter, ber_bch_31_21_supercode_3_matrix_1_iter, label="BCJR(31,21) supercode(3,1)", linewidth=2)

esno_bch_31_21_supercode_3_matrix_2_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8, 5.0, 5.2, 5.4,]
fer_bch_31_21_supercode_3_matrix_2_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9917355371900827, 0.9836065573770492, 0.9917355371900827, 0.967741935483871, 0.9230769230769231, 0.9448818897637795, 0.8695652173913043, 0.8695652173913043, 0.8391608391608392, 0.851063829787234, 0.7692307692307693, 0.718562874251497, 0.7142857142857143, 0.5581395348837209, 0.6349206349206349, 0.5607476635514018, 0.502092050209205, 0.39087947882736157, 0.4195804195804196, 0.37267080745341613, 0.31746031746031744, 0.27713625866050806, 0.1889763779527559, 0.17725258493353027, 0.18604651162790697, 0.1431980906921241, 0.0911854103343465, 0.08528784648187633, 0.06948465547191662, 0.05023022185014651, 0.03730183400683867, 0.040774719673802244, 0.019105238019423657, 0.017079419299743808, 0.012223693592747276, 0.0088008800880088, 0.00459911083857121, 0.0033743883921039312, 0.0024593187687010696, 0.001623750050742189, 0.0010316812105059536, 0.0006458140486082707, 0.00039911396699327494,]
ber_bch_31_21_supercode_3_matrix_2_iter = [0.328494623655914, 0.33521505376344085, 0.32741935483870965, 0.30537634408602155, 0.31102150537634404, 0.3131720430107527, 0.30940860215053767, 0.3099462365591398, 0.31747311827956987, 0.28736559139784945, 0.28763440860215056, 0.2836021505376344, 0.2736559139784946, 0.25806451612903225, 0.27553763440860213, 0.2639784946236559, 0.275, 0.2545698924731183, 0.2411290322580645, 0.2413978494623656, 0.7672043010752688, 0.764516129032258, 0.7661290322580645, 0.7669354838709678, 0.7825268817204302, 0.7938172043010753, 0.7948924731182796, 0.8002688172043011, 0.7973118279569892, 0.814247311827957, 0.8174731182795699, 0.8206989247311828, 0.825, 0.8228494623655913, 0.8333333333333334, 0.17888563049853373, 0.1509783183500793, 0.15142628632364705, 0.13709677419354838, 0.12580645161290324, 0.12268224536449072, 0.11804581580177652, 0.11056568489948573, 0.10872997969772163, 0.0990619995424388, 0.10318444995864351, 0.0907861695962913, 0.09062980030721966, 0.0663165791447862, 0.07270865335381464, 0.06331022007838408, 0.05641787015791605, 0.04528738047704108, 0.04906383938642003, 0.04047285113203767, 0.03123399897593446, 0.02555315503240706, 0.01828803657607315, 0.015628722542526324, 0.01765441360340085, 0.012472091769959196, 0.007084027845867241, 0.0072907352637733, 0.0053981358686515865, 0.0037537638909518082, 0.0027976375505129004, 0.00286080694485548, 0.0013712630513941174, 0.0010559856018658807, 0.0007787675756669635, 0.0005133846718005134, 0.00026086354487594765, 0.00018686129268102416, 0.00013420476076513903, 8.598891397747614e-05, 5.491206443015559e-05, 3.038103723291596e-05, 1.9955698349663746e-05,]
# plt.plot(esno_bch_31_21_supercode_3_matrix_2_iter, fer_bch_31_21_supercode_3_matrix_2_iter, label="BCJR(31,21) supercode(3,2)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_3_matrix_2_iter, ber_bch_31_21_supercode_3_matrix_2_iter, label="BCJR(31,21) supercode(3,2)", linewidth=2)

esno_bch_31_21_supercode_3_matrix_3_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6, 4.8,]
fer_bch_31_21_supercode_3_matrix_3_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.967741935483871, 0.967741935483871, 0.9375, 0.9375, 0.9302325581395349, 0.8571428571428571, 0.8, 0.8108108108108109, 0.8108108108108109, 0.7947019867549668, 0.6629834254143646, 0.6976744186046512, 0.6217616580310881, 0.4838709677419355, 0.502092050209205, 0.45454545454545453, 0.4316546762589928, 0.3468208092485549, 0.30848329048843187, 0.2926829268292683, 0.21505376344086022, 0.2376237623762376, 0.18838304552590268, 0.13029315960912052, 0.10743061772605192, 0.09302325581395349, 0.07566204287515763, 0.05042016806722689, 0.04352557127312296, 0.03487358326068003, 0.025657472738935216, 0.017513134851138354, 0.010923987255348202, 0.008900756564307966, 0.006086427267194157, 0.00422698932685195, 0.00211954217888936, 0.001405102865238926, 0.0009629968461853288, 0.0005524276895172242,]
ber_bch_31_21_supercode_3_matrix_3_iter = [0.6827956989247312, 0.6774193548387097, 0.6690860215053764, 0.6943548387096775, 0.692741935483871, 0.6916666666666667, 0.6870967741935484, 0.7123655913978495, 0.7172043010752688, 0.7096774193548386, 0.7048387096774194, 0.7217741935483871, 0.728494623655914, 0.7338709677419355, 0.7274193548387097, 0.7470430107526881, 0.7360215053763441, 0.7438172043010753, 0.7577956989247312, 0.7610215053763442, 0.768010752688172, 0.7661290322580645, 0.7588709677419355, 0.7709677419354839, 0.7733870967741936, 0.7844086021505376, 0.7846774193548387, 0.8048387096774193, 0.8043010752688172, 0.8163978494623656, 0.8193548387096775, 0.8225806451612903, 0.8260752688172043, 0.839516129032258, 0.8360215053763441, 0.15998959417273675, 0.15166493236212278, 0.13785282258064516, 0.13180443548387097, 0.14428607151787948, 0.1294930875576037, 0.12236559139784947, 0.12772449869224062, 0.12009590235396686, 0.13116855372783592, 0.09784352165389414, 0.10596399099774945, 0.08942002339963229, 0.07453173777315297, 0.07261438790660009, 0.06366080156402737, 0.05871431886748666, 0.04531046056311766, 0.036653122149431956, 0.03878835562549174, 0.028037923459359463, 0.029064196742254873, 0.022028662581657976, 0.014395292634233477, 0.012389176076472117, 0.01005251312828207, 0.007667900581702803, 0.005516400108430469, 0.004118548679607334, 0.00317799589391681, 0.0023312434907957263, 0.0015630002071446057, 0.0010395407226863613, 0.0008039393025826549, 0.0005595586358549468, 0.0003647482725589989, 0.00017434943729573767, 0.00011444789466865445, 7.429572442343799e-05, 3.890754157352493e-05,]
# plt.plot(esno_bch_31_21_supercode_3_matrix_3_iter, fer_bch_31_21_supercode_3_matrix_3_iter, label="BCJR(31,21) supercode(3,3)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_3_matrix_3_iter, ber_bch_31_21_supercode_3_matrix_3_iter, label="BCJR(31,21) supercode(3,3)", linewidth=2)


esno_bch_31_21_supercode_3_matrix_4_iter = [-10, -9.8, -9.6, -9.4, -9.2, -9.0, -8.8, -8.6, -8.4, -8.2, -8.0, -7.8, -7.6, -7.4, -7.2, -7.0, -6.8, -6.6, -6.4, -6.2, -6.0, -5.8, -5.6, -5.4, -5.2, -5.0, -4.8, -4.6, -4.4, -4.2, -4.0, -3.8, -3.6, -3.4, -3.2, -3.0, -2.8, -2.6, -2.4, -2.2, -2.0, -1.8, -1.6, -1.4, -1.2, -1.0, -0.8, -0.6, -0.4, -0.2, -0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.2, 1.4, 1.6, 1.8, 2.0, 2.2, 2.4, 2.6, 2.8, 3.0, 3.2, 3.4, 3.6, 3.8, 4.0, 4.2, 4.4, 4.6,]
fer_bch_31_21_supercode_3_matrix_4_iter = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9836065573770492, 0.96, 0.8571428571428571, 0.8275862068965517, 0.759493670886076, 0.7843137254901961, 0.7142857142857143, 0.7142857142857143, 0.6666666666666666, 0.5217391304347826, 0.5357142857142857, 0.5357142857142857, 0.5042016806722689, 0.4444444444444444, 0.40955631399317405, 0.3560830860534125, 0.2733485193621868, 0.2222222222222222, 0.24193548387096775, 0.192, 0.14423076923076922, 0.10909090909090909, 0.11363636363636363, 0.07537688442211055, 0.05188067444876784, 0.04302617425600574, 0.0332409972299169, 0.027353544563483018, 0.015414258188824663, 0.014072944763691803, 0.008251392422471292, 0.00693000693000693, 0.00429000429000429, 0.002230358901919967, 0.0017272897384595454, 0.0012943308309603934, 0.0006684901592677805, ]
ber_bch_31_21_supercode_3_matrix_4_iter = [0.32983870967741935, 0.31612903225806455, 0.3131720430107527, 0.31451612903225806, 0.31397849462365596, 0.31962365591397845, 0.31666666666666665, 0.2986559139784946, 0.3, 0.28655913978494624, 0.2887096774193549, 0.2887096774193549, 0.2803763440860215, 0.282258064516129, 0.25725806451612904, 0.2741935483870968, 0.24919354838709676, 0.24623655913978493, 0.24301075268817204, 0.2446236559139785, 0.7583333333333333, 0.7639784946236559, 0.7639784946236559, 0.7704301075268817, 0.7865591397849463, 0.796505376344086, 0.7876344086021505, 0.8051075268817204, 0.7946236559139785, 0.817741935483871, 0.8, 0.8172043010752688, 0.8279569892473119, 0.8301075268817204, 0.8290322580645161, 0.17204301075268816, 0.17204301075268816, 0.14569011105235324, 0.13496774193548386, 0.12027649769585254, 0.13459399332591768, 0.1322988975091874, 0.13725490196078433, 0.12211981566820276, 0.1205837173579109, 0.10949820788530466, 0.08527349228611501, 0.08640552995391705, 0.08683755760368664, 0.0801030089455137, 0.06499402628434886, 0.058901244082351645, 0.04833923614434766, 0.03931221985450804, 0.03106332138590203, 0.031087408949011446, 0.02544516129032258, 0.017951302729528537, 0.01310850439882698, 0.01386852394916911, 0.009604473982817312, 0.0063177272917451155, 0.004985021802241525, 0.0035832365293539453, 0.0029706537644212743, 0.0016781652060413948, 0.0015926639100844755, 0.0009027733107381226, 0.0007321216998636353, 0.00045552464907303616, 0.0002308301551718246, 0.0001764435754340396, 0.0001245619455601669, 6.66693142710609e-05,]
# plt.plot(esno_bch_31_21_supercode_3_matrix_4_iter, fer_bch_31_21_supercode_3_matrix_4_iter, label="BCJR(31,21) supercode(3,4)", linewidth=2)
plt.plot(esno_bch_31_21_supercode_3_matrix_4_iter, ber_bch_31_21_supercode_3_matrix_4_iter, label="BCJR(31,21) supercode(3,4)", linewidth=2)

esno_bch_31_21_supercode_3_matrix_5_iter = []
fer_bch_31_21_supercode_3_matrix_5_iter = []
# ber_bch_31_21_supercode_3_matrix_5_iter = []
plt.plot(esno_bch_31_21_supercode_3_matrix_5_iter, fer_bch_31_21_supercode_3_matrix_5_iter, label="BCJR(31,21) supercode(3,5)", linewidth=2)


plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("BER")
plt.title("BCH(31, 21)")
plt.legend()
plt.grid(True, which="both", linestyle="--")
plt.savefig('modeling_results/BCH(31,21)_complex_awgn_BER.png', dpi=300, bbox_inches='tight')