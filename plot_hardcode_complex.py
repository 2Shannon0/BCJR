import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter1d
import numpy as np

# -----------------------BCH(15,5) original-------------------------
esno_bch_15_5 = [-10, -9.6, -9.2, -8.8, -8.4, -8.0, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6]
fer_bch_15_5 = [1.0, 1.0, 1.0, 0.9803921568627451, 0.9803921568627451, 0.9433962264150944, 0.9615384615384616, 0.9259259259259259, 1.0, 0.7352941176470589, 0.819672131147541, 0.625, 0.5208333333333334, 0.44642857142857145, 0.3105590062111801, 0.25510204081632654, 0.15479876160990713, 0.12135922330097088, 0.0847457627118644, 0.041254125412541254, 0.02844141069397042, 0.019223375624759707, 0.012729124236252547, 0.006827802813054759, 0.0037764350453172208, 0.001496602711844114, 0.0011052166224580018, 0.00038920198025967556, 0.00012976732718236202, 4.7295143450899604e-05]
ber_bch_15_5 = [0.29333333333333333, 0.33333333333333337, 0.3306666666666667, 0.3006535947712418, 0.2679738562091503, 0.2729559748427673, 0.258974358974359, 0.23333333333333334, 0.2333333333333333, 0.19705882352941176, 0.19781420765027322, 0.14583333333333331, 0.125, 0.1130952380952381, 0.07204968944099378, 0.06054421768707483, 0.043343653250773995, 0.03446601941747573, 0.02576271186440678, 0.014136413641364136, 0.009859689040576412, 0.00786876842240164, 0.005431093007467753, 0.002958714552323729, 0.0017119838872104733, 0.0006505233120815748, 0.0005216622458001769, 0.00018214652676152814, 6.15962246358945e-05, 2.2197187326288878e-05]

#----------------------BCH(15,5) supercode-----------------------------------------------------

esno_bch_15_5_m2_i2 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4]
fer_bch_15_5_m2_i2 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9433962264150944, 0.6578947368421053, 0.38461538461538464, 0.3787878787878788, 0.16393442622950818, 0.10989010989010989, 0.08077544426494346, 0.043215211754537596, 0.031269543464665414, 0.021542438604049977, 0.013344008540165465, 0.0065832784726793945, 0.004061408496466574, 0.00224870699347875, 0.001294565414390389, 0.0005519007461698088, 0.000125870699347445]
ber_bch_15_5_m2_i2 = [0.7106666666666667, 0.716, 0.772, 0.7773333333333333, 0.7826666666666666, 0.7293333333333334, 0.7706666666666666, 0.7879999999999999, 0.7626666666666666, 0.7066666666666667, 0.4880503144654088, 0.26842105263157895, 0.12205128205128206, 0.09292929292929293, 0.04633879781420765, 0.02432234432234432, 0.01830910070005385, 0.009853068280034573, 0.0072545340838023765, 0.004251041217865863, 0.00275776176496753, 0.0013078779899056397, 0.0008826794465654022, 0.00038377932688703995, 0.00023129568737108286, 9.198345769496814e-05, 6.398645736939678e-05]

esno_bch_15_5_m2_i3 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0]
fer_bch_15_5_m2_i3 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9615384615384616, 0.6578947368421053, 0.33783783783783783, 0.15527950310559005, 0.11061946902654868, 0.0625782227784731, 0.04995004995004995, 0.026497085320614733, 0.01626545217957059, 0.011061946902654867, 0.0061312078479460455, 0.0036392750564087635, 0.002457123200157256, 0.0011116298717179127, 0.0005679043194802539, 0.00009863323205572215]
ber_bch_15_5_m2_i3 = [0.7240000000000001, 0.7413333333333334, 0.7346666666666667, 0.748, 0.7493333333333334, 0.748, 0.7373333333333334, 0.7506666666666666, 0.7546666666666667, 0.7093333333333334, 0.532051282051282, 0.2719298245614035, 0.12072072072072072, 0.04989648033126294, 0.030530973451327437, 0.017271589486858575, 0.016516816516816517, 0.00734852499558382, 0.004684450227716331, 0.003023598820058997, 0.00170038830983037, 0.0008054928791518063, 0.0007273084672465477, 0.00024604074494023135, 0.0001287249790821909, 6.398645736939678e-05]


esno_bch_15_5_m3_i2 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6]
fer_bch_15_5_m3_i2 = [0.9803921568627451, 1.0, 0.9803921568627451, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9259259259259259, 0.6410256410256411, 0.43478260869565216, 0.2222222222222222, 0.18726591760299627, 0.1272264631043257, 0.12531328320802004, 0.08025682182985554, 0.07656967840735068, 0.04240882103477523, 0.027793218454697052, 0.019904458598726114, 0.015913430935709738, 0.010098969905069683, 0.004552075746540422, 0.0027100271002710027, 0.0016214813853936956, 0.000902429339782695, 0.0004571553962622975]
ber_bch_15_5_m3_i2 = [0.28627450980392155, 0.292, 0.2522875816993464, 0.26533333333333337, 0.3, 0.732, 0.8079999999999999, 0.8346666666666667, 0.8253333333333334, 0.8386666666666666, 0.7586666666666666, 0.5296296296296297, 0.20769230769230768, 0.09449275362318842, 0.05096296296296297, 0.0369538077403246, 0.02001696352841391, 0.021052631578947368, 0.013055109684323166, 0.011944869831546707, 0.0058806898501554995, 0.004187511580507689, 0.0030785562632696392, 0.0017823042647994907, 0.001333064027469198, 0.0004612770089827628, 0.0002493224932249322, 0.00015133826263674495, 8.422673837971821e-05, 4.1448755927781634e-05]

esno_bch_15_5_m3_i3 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8]
fer_bch_15_5_m3_i3 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.967741935483871, 0.5084745762711864, 0.22900763358778625, 0.13953488372093023, 0.11764705882352941, 0.07194244604316546, 0.055762081784386616, 0.04777070063694268, 0.026572187776793623, 0.020242914979757085, 0.012914334911752045, 0.009239297813366184, 0.0043642711667151585, 0.0025722369887678986, 0.001475071295112597, 0.0004954910316123278, 0.0002134803337306317]
ber_bch_15_5_m3_i3 = [0.7333333333333333, 0.7200000000000001, 0.74, 0.7266666666666667, 0.7844444444444445, 0.7555555555555556, 0.7555555555555556, 0.7711111111111111, 0.7866666666666667, 0.7666666666666667, 0.7666666666666667, 0.5806451612903226, 0.22372881355932203, 0.06768447837150128, 0.04186046511627907, 0.02875816993464052, 0.016147082334132694, 0.01536555142503098, 0.009978768577494692, 0.005727782698553292, 0.004858299595141701, 0.0033577270770555317, 0.0019915819731033775, 0.0007661720492677722, 0.00042870616479464977, 0.00026223489690890616, 8.148074742069391e-05, 3.8429021597110135e-05]



esno_bch_15_5_m4_i2 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0, 4.4]
fer_bch_15_5_m4_i2 = [1.0, 1.0, 0.9803921568627451, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.7352941176470589, 0.4807692307692308, 0.3067484662576687, 0.25125628140703515, 0.29069767441860467, 0.23809523809523808, 0.21367521367521367, 0.16339869281045752, 0.12224938875305623, 0.07278020378457059, 0.08025682182985554, 0.05952380952380952, 0.031017369727047148, 0.02513826043237808, 0.012428535918468804, 0.010905125408942203, 0.0073003358154475105, 0.0039035053478023267, 0.002549329526334574, 0.0011591246290801186]
ber_bch_15_5_m4_i2 = [0.28933333333333333, 0.304, 0.265359477124183, 0.252, 0.24133333333333332, 0.22399999999999998, 0.24533333333333335, 0.2853333333333333, 0.6493333333333333, 0.8533333333333333, 0.8493333333333334, 0.6920000000000001, 0.2950980392156863, 0.1032051282051282, 0.05521472392638037, 0.04355108877721943, 0.04573643410852713, 0.04095238095238095, 0.028774928774928776, 0.020043572984749458, 0.015321923390383048, 0.006501698204754974, 0.008132691278758694, 0.0057936507936507935, 0.00293631100082713, 0.002547343723814312, 0.0009611401110282542, 0.0007997091966557615, 0.0005548255219740108, 0.0002810523850417675, 0.0001869508319312021, 8.036597428288823e-05]

esno_bch_15_5_m4_i3 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6]
fer_bch_15_5_m4_i3 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6666666666666666, 0.32967032967032966, 0.21428571428571427, 0.16129032258064516, 0.11450381679389313, 0.0872093023255814, 0.0911854103343465, 0.07009345794392523, 0.058823529411764705, 0.04076086956521739, 0.021567217828900073, 0.018018018018018018, 0.009475679090334808, 0.008998200359928014, 0.006127450980392157, 0.0033462722527104805, 0.0009475679090334808, 0.0004998200359928014]
ber_bch_15_5_m4_i3 = [0.7088888888888889, 0.7311111111111112, 0.7333333333333333, 0.7511111111111112, 0.74, 0.74, 0.7444444444444444, 0.7622222222222222, 0.7711111111111111, 0.7511111111111112, 0.8044444444444444, 0.7333333333333333, 0.30814814814814817, 0.09304029304029304, 0.05476190476190476, 0.03620071684587814, 0.022900763358778626, 0.019573643410852715, 0.012968591691995946, 0.012928348909657321, 0.006013071895424837, 0.006521739130434782, 0.0026359932901988976, 0.002042042042042042, 0.0010107391029690461, 0.0010397920415916816, 0.0006862745098039215, 0.0002766251728907331, 0.00010107391029690461, 0.000090397920415916816]

esno_bch_15_5_m4_i4 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2]
fer_bch_15_5_m4_i4 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5434782608695652, 0.29411764705882354, 0.14705882352941177, 0.09124087591240876, 0.07861635220125786, 0.05482456140350877, 0.03324468085106383, 0.027777777777777776, 0.029585798816568046, 0.020868113522537562, 0.01172607879924953, 0.008547008547008548, 0.004575402635431918, 0.0029083294555607257, 0.001561914282144196, 0.0007576675960722512, 0.0003543446592385527]
ber_bch_15_5_m4_i4 = [0.28800000000000003, 0.2826666666666667, 0.28, 0.30133333333333334, 0.2613333333333333, 0.2773333333333333, 0.28, 0.2906666666666667, 0.544, 0.84, 0.8186666666666667, 0.7386666666666666, 0.20869565217391303, 0.08941176470588234, 0.04196078431372549, 0.02944038929440389, 0.025157232704402517, 0.01608187134502924, 0.006028368794326241, 0.006666666666666667, 0.004654832347140039, 0.003450194769059544, 0.0017510944340212633, 0.001094017094017094, 0.0007564665690580772, 0.0004110438963859159, 0.0001999250281144571, 9.092011152867015e-05, 2.8872527789807997e-05]



# plt.plot(esno_bch_15_5, gaussian_filter1d(fer_bch_15_5, sigma=1), label="bcjr classic", alpha=1, linewidth=2)
# plt.plot(esno_bch_15_5_m4_i2, gaussian_filter1d(fer_bch_15_5_m4_i2, sigma=1), label="super m=4, i=2", alpha=1, linewidth=2)
# plt.plot(esno_bch_15_5_m4_i3, gaussian_filter1d(fer_bch_15_5_m4_i3, sigma=1), label="super m=4, i=3", alpha=1, linewidth=2)
# plt.plot(esno_bch_15_5_m4_i4, gaussian_filter1d(fer_bch_15_5_m4_i4, sigma=1), label="super m=4, i=4", alpha=1, linewidth=2)

# -----------------------BCH(15,7) original-------------------------

esno_bch_15_7 = [-10, -9.6, -9.2, -8.8, -8.4, -8.0, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4]
fer_bch_15_7 = [0.9900990099009901, 1.0, 1.0, 1.0, 1.0, 0.9615384615384616, 0.9900990099009901, 0.9523809523809523, 0.970873786407767, 0.9900990099009901, 0.9523809523809523, 0.9345794392523364, 0.8620689655172413, 0.8547008547008547, 0.7246376811594203, 0.6410256410256411, 0.5025125628140703, 0.39215686274509803, 0.3816793893129771, 0.25380710659898476, 0.15384615384615385, 0.11299435028248588, 0.0846740050804403, 0.050454086781029264, 0.030349013657056147, 0.016142050040355124, 0.00991571641051066, 0.006907985631389887, 0.0031098395322801346, 0.0014136873206384213, 0.000776264923693158, 0.00038547974882139567]
ber_bch_15_7 = [0.3234323432343234, 0.326, 0.31733333333333336, 0.31533333333333335, 0.308, 0.2717948717948718, 0.25676567656765675, 0.26412698412698415, 0.25889967637540456, 0.22376237623762377, 0.23238095238095235, 0.19750778816199377, 0.18735632183908046, 0.19316239316239317, 0.15169082125603864, 0.12692307692307692, 0.10653266331658291, 0.08522875816993464, 0.07709923664122137, 0.05854483925549915, 0.03743589743589743, 0.032090395480225985, 0.02218458933107536, 0.01584258324924319, 0.009549822964087, 0.005412967446865751, 0.003331680713931582, 0.002380952380952381, 0.0010967367417174607, 0.0004929056457959295, 0.0002665176238013176, 0.00013491791208748849]

#----------------------BCH(15,7) supercode-----------------------------------------------------

esno_bch_15_7_m2_i2 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6]
fer_bch_15_7_m2_i2 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9803921568627451, 0.7246376811594203, 0.6410256410256411, 0.36496350364963503, 0.27932960893854747, 0.22123893805309736, 0.18115942028985507, 0.1141552511415525, 0.1201923076923077, 0.06097560975609756, 0.047080979284369114, 0.024189646831156264, 0.018477457501847747, 0.010996261271167804, 0.0070731362286037625, 0.0037408349543618137, 0.0016939964764873289, 0.0010664619059807183, 0.0005643149780481474]
ber_bch_15_7_m2_i2 = [0.7213333333333334, 0.748, 0.7133333333333333, 0.7586666666666666, 0.768, 0.7706666666666666, 0.764, 0.7693333333333334, 0.7786666666666666, 0.7973333333333333, 0.7559999999999999, 0.5934640522875817, 0.3033816425120773, 0.1547008547008547, 0.07688564476885645, 0.06256983240223463, 0.04660766961651917, 0.035265700483091786, 0.0228310502283105, 0.020512820512820513, 0.011056910569105691, 0.006465787821720025, 0.003676826318335752, 0.0030549396403054944, 0.0016567700315226156, 0.0009525156787853067, 0.00040899795501022495, 0.0001852102814292813, 0.00011659983505389188, 5.0412138038967834e-05]

esno_bch_15_7_m2_i3 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8]
fer_bch_15_7_m2_i3 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6521739130434783, 0.3333333333333333, 0.24390243902439024, 0.2158273381294964, 0.1935483870967742, 0.12195121951219512, 0.0539568345323741, 0.066815144766147, 0.03058103975535168, 0.025423728813559324, 0.014077897700610043, 0.0068368277119416595, 0.005842259006815969, 0.0024555946631742652, 0.0016678712403402458, 0.0009502692429521698, 0]
ber_bch_15_7_m2_i3 = [0.711111111111111, 0.7355555555555555, 0.7155555555555555, 0.7288888888888889, 0.7466666666666666, 0.7311111111111112, 0.7911111111111111, 0.8022222222222222, 0.7666666666666667, 0.7733333333333333, 0.7288888888888889, 0.5444444444444444, 0.2753623188405797, 0.09407407407407407, 0.05149051490514905, 0.0460431654676259, 0.05634408602150537, 0.02628726287262873, 0.011630695443645084, 0.017223459539717892, 0.007135575942915392, 0.005932203389830509, 0.003503832316596277, 0.0015648738985110907, 0.0013242453748782863, 0.0005074895637226816, 0.00031133596486351253, 0.00019005384859043396]

esno_bch_15_7_m2_i4 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4]
fer_bch_15_7_m2_i4 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.6521739130434783, 0.379746835443038, 0.3, 0.16853932584269662, 0.17045454545454544, 0.10909090909090909, 0.1048951048951049, 0.058027079303675046, 0.03436426116838488, 0.015789473684210527, 0.0125, 0.0067598017124831005, 0.002915168593917015, 0.0018992149911369967, 0.0008232570105479804]
ber_bch_15_7_m2_i4 = [0.7488888888888888, 0.7644444444444445, 0.74, 0.7244444444444444, 0.7866666666666667, 0.7488888888888888, 0.7644444444444445, 0.8088888888888889, 0.7799999999999999, 0.7777777777777778, 0.7466666666666666, 0.5933333333333334, 0.2826086956521739, 0.10042194092827005, 0.09133333333333332, 0.04681647940074907, 0.04242424242424243, 0.032242424242424246, 0.03403263403263403, 0.016634429400386848, 0.010614738449789997, 0.004245614035087719, 0.002861111111111111, 0.0018627009163286767, 0.000796812749003984, 0.00046425255338904364, 0.00015779092702169627]


esno_bch_15_7_m3_i2 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0]
fer_bch_15_7_m3_i2 = [0.9803921568627451, 1.0, 1.0, 0.9803921568627451, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8928571428571429, 0.6024096385542169, 0.4166666666666667, 0.2857142857142857, 0.30303030303030304, 0.1976284584980237, 0.1976284584980237, 0.12953367875647667, 0.10638297872340426, 0.0632111251580278, 0.05296610169491525, 0.037009622501850484, 0.029585798816568046, 0.015069318866787222, 0.011091393078970719, 0.006040106305870983, 0.0048216007714561235, 0.0023400570973931764, 0.0011228637517123673]
ber_bch_15_7_m3_i2 = [0.29934640522875816, 0.2613333333333333, 0.26266666666666666, 0.26143790849673204, 0.2613333333333333, 0.74, 0.7933333333333333, 0.7973333333333333, 0.7853333333333333, 0.8253333333333334, 0.8146666666666667, 0.7253333333333333, 0.3904761904761905, 0.14457831325301204, 0.08833333333333333, 0.053714285714285714, 0.06303030303030303, 0.034255599472990776, 0.034782608695652174, 0.023488773747841106, 0.01801418439716312, 0.00834386852085967, 0.006850282485875706, 0.004490500863557859, 0.003076923076923077, 0.0015270243118344384, 0.0011830819284235432, 0.0005476363050656358, 0.0003857280617164899, 0.000159123882622736, 8.683479679908974e-05]

esno_bch_15_7_m3_i4 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8]
fer_bch_15_7_m3_i4 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8771929824561403, 0.36496350364963503, 0.23809523809523808, 0.16835016835016836, 0.1201923076923077, 0.10638297872340426, 0.06031363088057901, 0.0655307994757536, 0.03558718861209965, 0.02765486725663717, 0.01392369813422445, 0.0098405825624877, 0.005466870763175159, 0.0033123550844650546, 0.0020676536266644612, 0.000863128710799571]
ber_bch_15_7_m3_i4 = [0.29466666666666663, 0.25733333333333336, 0.252, 0.2613333333333333, 0.26533333333333337, 0.7026666666666667, 0.7786666666666666, 0.7879999999999999, 0.7986666666666666, 0.8320000000000001, 0.812, 0.696, 0.42105263157894735, 0.09683698296836983, 0.06063492063492063, 0.04938271604938271, 0.038141025641025644, 0.02921985815602837, 0.016405307599517492, 0.018785495849716033, 0.009205219454329774, 0.007153392330383481, 0.0028775642810730533, 0.0024142229219969824, 0.0011808440848458343, 0.0006801369106768247, 0.0004493700548617429, 0.0001726257421599142]

esno_bch_15_7_m3_i6 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4]
fer_bch_15_7_m3_i6 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9090909090909091, 0.410958904109589, 0.17543859649122806, 0.18633540372670807, 0.12295081967213115, 0.05725190839694656, 0.07575757575757576, 0.04005340453938585, 0.027752081406105456, 0.016713091922005572, 0.011695906432748537, 0.006372132540356839, 0.0039593506664906955, 0.0018800526414739613, 0.0007412898443291327]
ber_bch_15_7_m3_i6 = [0.3022222222222222, 0.2977777777777778, 0.2777777777777778, 0.23333333333333334, 0.2777777777777778, 0.7177777777777778, 0.7799999999999999, 0.7777777777777778, 0.7777777777777778, 0.8222222222222223, 0.7622222222222222, 0.7244444444444444, 0.43232323232323233, 0.12054794520547946, 0.056920077972709544, 0.06708074534161491, 0.037978142076502734, 0.01806615776081425, 0.02592592592592593, 0.013618157543391187, 0.009435707678075856, 0.005422469823584029, 0.0036907082521117607, 0.001869158878504673, 0.0012317979851304388, 0.0005305926343715402, 0.00013590313812700765]

esno_bch_15_7_m3_i8 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6]
fer_bch_15_7_m3_i8 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8333333333333334, 0.379746835443038, 0.16216216216216217, 0.11235955056179775, 0.12396694214876033, 0.07352941176470588, 0.04608294930875576, 0.033783783783783786, 0.028222013170272814, 0.023923444976076555, 0.011001100110011002, 0.008021390374331552, 0.0038289725590299937]
ber_bch_15_7_m3_i8 = [0.2866666666666667, 0.2644444444444444, 0.2911111111111111, 0.28888888888888886, 0.2822222222222222, 0.7133333333333333, 0.8733333333333333, 0.76, 0.8022222222222222, 0.7911111111111111, 0.8133333333333332, 0.711111111111111, 0.4148148148148148, 0.08270042194092826, 0.04864864864864865, 0.04094881398252185, 0.04407713498622589, 0.025490196078431372, 0.01638504864311316, 0.011786786786786787, 0.009532768893069928, 0.007921318447634237, 0.00374037403740374, 0.002602495543672014, 0.001242288874707509]


esno_bch_15_7_m4_i2 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0]
fer_bch_15_7_m4_i2 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8823529411764706, 0.6122448979591837, 0.45454545454545453, 0.4166666666666667, 0.2912621359223301, 0.22900763358778625, 0.1986754966887417, 0.2, 0.16304347826086957, 0.09174311926605505, 0.0970873786407767, 0.07092198581560284, 0.04457652303120357, 0.03289473684210526, 0.03389830508474576, 0.016304347826086956, 0.008625646923519264, 0.006531678641410843, 0.00373087924387514]
ber_bch_15_7_m4_i2 = [0.2644444444444444, 0.23333333333333334, 0.28444444444444444, 0.26, 0.24666666666666667, 0.2555555555555556, 0.2555555555555556, 0.2555555555555556, 0.5044444444444445, 0.8044444444444444, 0.8266666666666667, 0.8, 0.4215686274509804, 0.14965986394557823, 0.07777777777777778, 0.06666666666666667, 0.0517799352750809, 0.03867684478371501, 0.03532008830022075, 0.029333333333333336, 0.021014492753623187, 0.011009174311926606, 0.010571736785329019, 0.00756501182033097, 0.003566121842496285, 0.0036549707602339184, 0.002937853107344633, 0.0011956521739130436, 0.0006517155453325666, 0.0004499600841860803, 0.0002653069684533433]

esno_bch_15_7_m4_i4 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8, 3.2, 3.6, 4.0]
fer_bch_15_7_m4_i4 = [1.0, 0.967741935483871, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9090909090909091, 0.3614457831325301, 0.26548672566371684, 0.17341040462427745, 0.15706806282722513, 0.09771986970684039, 0.06726457399103139, 0.07352941176470588, 0.06437768240343347, 0.051457975986277875, 0.024549918166939442, 0.023529411764705882, 0.013831258644536652, 0.007058823529411765, 0.003994141925176408, 0.0017816842855446016, 0.0011739845034045551, 0.0006094464195022854, 0.00015018397536982803]
ber_bch_15_7_m4_i4 = [0.33999999999999997, 0.27741935483870966, 0.2688888888888889, 0.2644444444444444, 0.24222222222222223, 0.24888888888888888, 0.2977777777777778, 0.29555555555555557, 0.44222222222222224, 0.8288888888888889, 0.8222222222222223, 0.7755555555555556, 0.42626262626262623, 0.08755020080321285, 0.07669616519174041, 0.04701348747591522, 0.04851657940663177, 0.023235613463626494, 0.015844544095665172, 0.016993464052287584, 0.011444921316165951, 0.009491137793024585, 0.005182760501909437, 0.004287581699346405, 0.0021207929921622866, 0.0009411764705882353, 0.0005503039985798607, 0.0002415172031516015, 0.00014087814040854662, 5.68816658202133e-05, 1.0012265024655203e-05]

esno_bch_15_7_m4_i8 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4, 2.8]
fer_bch_15_7_m4_i8 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.8823529411764706, 0.32608695652173914, 0.17751479289940827, 0.16666666666666666, 0.13100436681222707, 0.08498583569405099, 0.07389162561576355, 0.04437869822485207, 0.029097963142580018, 0.025041736227045076, 0.011082379017362394, 0.0091324200913242, 0.0037931470476672145, 0.0028876696505919725, 0.0013701758392327015, 0.0005078720162519045]
ber_bch_15_7_m4_i8 = [0.3022222222222222, 0.29333333333333333, 0.30888888888888894, 0.2733333333333333, 0.3111111111111111, 0.33999999999999997, 0.26666666666666666, 0.3044444444444444, 0.47555555555555556, 0.8266666666666667, 0.8044444444444444, 0.7755555555555556, 0.4196078431372549, 0.08188405797101449, 0.0631163708086785, 0.057407407407407414, 0.04687045123726346, 0.030972615675165252, 0.024137931034482762, 0.015088757396449702, 0.009569996766892984, 0.007846410684474123, 0.0029553010712966383, 0.002597666159309995, 0.0011969486239305433, 0.0008213815895017166, 0.00036538022379538706, 5.0787201625190454e-05]

esno_bch_15_7_m4_i10 = [-8, -7.6, -7.2, -6.8, -6.4, -6.0, -5.6, -5.2, -4.8, -4.4, -4.0, -3.6, -3.2, -2.8, -2.4, -2.0, -1.6, -1.2, -0.8, -0.4, 0.0, 0.4, 0.8, 1.2, 1.6, 2.0, 2.4]
fer_bch_15_7_m4_i10 = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9523809523809523, 0.3076923076923077, 0.18691588785046728, 0.16, 0.10752688172043011, 0.04672897196261682, 0.043010752688172046, 0.04784688995215311, 0.03944773175542406, 0.03189792663476874, 0.01532567049808429, 0.006956521739130435, 0.004127115146512587, 0.0020764119601328905, 0.0007757951900698216]
ber_bch_15_7_m4_i10 = [0.33333333333333337, 0.2966666666666667, 0.31666666666666665, 0.32666666666666666, 0.30333333333333334, 0.36, 0.3066666666666667, 0.30333333333333334, 0.4066666666666666, 0.8566666666666667, 0.8, 0.7966666666666666, 0.4920634920634921, 0.09333333333333332, 0.06355140186915888, 0.05973333333333333, 0.040860215053763436, 0.016822429906542057, 0.015340501792114696, 0.01690590111642743, 0.013675213675213675, 0.009782030834662414, 0.0048020434227330775, 0.002179710144927536, 0.0013069197963956527, 0.0006436877076411961, 0.00021980863718644943]


plt.plot(esno_bch_15_7, gaussian_filter1d(fer_bch_15_7, sigma=1), label="bcjr classic", alpha=1, linewidth=2)
plt.plot(esno_bch_15_7_m4_i2, gaussian_filter1d(fer_bch_15_7_m4_i2, sigma=1), label="super m=4, i=2", alpha=1, linewidth=2)
plt.plot(esno_bch_15_7_m4_i4, gaussian_filter1d(fer_bch_15_7_m4_i4, sigma=1), label="super m=4, i=4", alpha=1, linewidth=2)

# -----------------------BCH(15,11) original-------------------------

#----------------------BCH(15,11) supercode-----------------------------------------------------



plt.yscale("log")  # Логарифмическая шкала по Y
plt.xlabel("EsNo [dB]")
plt.ylabel("FER")
plt.title("BCH(15,7)")
plt.legend()
plt.grid(True, which="both", linestyle="--")
plt.show()
# plt.savefig('modeling_results/BCH(31,26-21-16).png', dpi=300, bbox_inches='tight')